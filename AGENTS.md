<!-- Generated by Ruler -->


<!-- Source: .ruler/AGENTS.md -->

# AGENTS.md

í•­ìƒ í•œê¸€ë¡œ ëŒ€ë‹µí•˜ì„¸ìš”.

## ë¬¸ì„œ ê´€ë¦¬ ê·œì¹™

### ì½”ë“œ ìƒì„± ì´í›„ ë¬¸ì„œ ì—…ë°ì´íŠ¸
ì½”ë“œ ìƒì„± ë° ê¸°ëŠ¥ ê°œë°œ ì™„ë£Œ ì‹œ ë‹¤ìŒ ë¬¸ì„œë“¤ì„ ë°˜ë“œì‹œ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”:

1. **.ruler/PLAN.md** â€” ì™„ë£Œëœ Task ì²´í¬ ë° ì§„í–‰ ìƒí™© ìˆ˜ì •
2. **.ruler/TASKS.md** â€” Task ì²´í¬ë°•ìŠ¤ ì—…ë°ì´íŠ¸
3. **.ruler/ARCHITECTURE.md** â€” í”„ë¡œì íŠ¸ êµ¬ì¡° ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸

### ARCHITECTURE.md ì—…ë°ì´íŠ¸ ê·œì¹™

**ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ì‹œì **:
- ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ ë˜ëŠ” íŒŒì¼ ì¶”ê°€ ì‹œ
- FSD Layer êµ¬ì¡° ë³€ê²½ ì‹œ
- ì•„í‚¤í…ì²˜ íŒ¨í„´ ë³€ê²½ ì‹œ
- ì£¼ìš” ê¸°ëŠ¥ ê°œë°œ ì™„ë£Œ ì‹œ (Epic ë‹¨ìœ„)

**ì—…ë°ì´íŠ¸ ì‹œ ì¤€ìˆ˜ ì‚¬í•­**:
- `.gitignore`ì— ë“±ì¬ëœ í•­ëª©ì€ ARCHITECTURE.mdì—ì„œ ì œì™¸
- êµ¬ì¡°ì— ëŒ€í•œ ëª…í™•í•œ ì„¤ëª… í¬í•¨
- FSD ì˜ì¡´ì„± ê·œì¹™ ì¤€ìˆ˜ ì—¬ë¶€ í™•ì¸
- Update Protocol í˜•ì‹ì— ë”°ë¼ ë³€ê²½ ì´ë ¥ ê¸°ë¡

**Update Format**:
```markdown
## [ë‚ ì§œ] ì—…ë°ì´íŠ¸
- ì¶”ê°€: [ë””ë ‰í† ë¦¬/íŒŒì¼ ê²½ë¡œ] â€” [ì„¤ëª…]
- ë³€ê²½: [ê¸°ì¡´ êµ¬ì¡°] â†’ [ìƒˆ êµ¬ì¡°]
- ì‚­ì œ: [ë””ë ‰í† ë¦¬/íŒŒì¼ ê²½ë¡œ] â€” [ì‚¬ìœ ]
```

## FSD ì•„í‚¤í…ì²˜ ê·œì¹™

### Layer êµ¬ì¡° ê·œì¹™

**ì¼ë°˜ Layer** (pages, widgets, features, entities):
```
Layer â†’ Slice â†’ Segment

ì˜ˆì‹œ:
entities/user/model        âœ…
features/auth/ui           âœ…
pages/home/ui              âœ…
widgets/header/ui          âœ…
```

**íŠ¹ìˆ˜ Layer** (app, shared):
```
Layer â†’ Segment (Slice ì—†ìŒ!)

ì˜ˆì‹œ:
app/router/step-router.tsx     âœ…
app/providers/query-provider.tsx  âœ…
shared/ui/button.tsx       âœ…
shared/lib/utils.ts        âœ…

app/router/ui/step-router.tsx  âŒ (uiëŠ” ë¶ˆí•„ìš”í•œ ì¤‘ì²©)
shared/components/ui/button.tsx  âœ… (componentsëŠ” Segment)
```

**í•µì‹¬ ê·œì¹™**:
1. `app`ê³¼ `shared` LayerëŠ” **Slices ì—†ì´ ë°”ë¡œ Segments**ë¡œ êµ¬ì„±
2. Segment ë‚´ë¶€ëŠ” í•„ìš”ì— ë”°ë¼ ì¶”ê°€ ë””ë ‰í† ë¦¬ êµ¬ì„± ê°€ëŠ¥ (ì˜ˆ: `shared/components/ui/`)
3. Public APIëŠ” ê° Slice/Segmentì˜ ìµœìƒìœ„ì— `index.ts`ë¡œ ë…¸ì¶œ

### ì˜ì¡´ì„± ê·œì¹™

```
app â†’ pages â†’ widgets â†’ features â†’ entities â†’ shared
```

- ìƒìœ„ LayerëŠ” í•˜ìœ„ Layerë§Œ ì°¸ì¡° ê°€ëŠ¥
- ê°™ì€ Layer ê°„ ì°¸ì¡° ê¸ˆì§€
- í•˜ìœ„ LayerëŠ” ìƒìœ„ Layer ì ˆëŒ€ ì°¸ì¡° ë¶ˆê°€

---

## Github MCP ì‚¬ìš© ê´€ë ¨ ì •ì˜

- Github ì €ì¥ì†Œ ìœ„ì¹˜: `soon-log/lateproof`
- Issue ìƒì„± ì‹œ Label: `feat`, `chore`, `design`, `docs`, `fix`, `infra`, `refactor` ì¤‘ ì ì ˆí•˜ê²Œ ì„¤ì •

## ì½”ë“œ í’ˆì§ˆ ê¸°ì¤€

- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ ì¤€ìˆ˜
- íŒŒì¼ë‹¹ ì½”ë“œì˜ ì¤„ ìˆ˜ëŠ” 500ì¤„ì„ ë„˜ê¸°ì§€ ì•Šë„ë¡ ê¶Œì¥
- ì½”ë“œ(íŒŒì¼) ìˆ˜ì •/ì¶”ê°€ í›„ `pnpm check`ë¥¼ ì‹¤í–‰í•˜ê³ , ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šì„ ë•Œê¹Œì§€ ìˆ˜ì •Â·ë³´ì™„í•œë‹¤ (Biome ì„¤ì • ìˆ˜ì • ê¸ˆì§€)
- ê¸°ëŠ¥ ì¶”ê°€/ìˆ˜ì • í›„ `pnpm tsc`ë¥¼ ì‹¤í–‰í•˜ì—¬ íƒ€ì… ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ê³ , íƒ€ì… ì—ëŸ¬ê°€ ì—†ì„ ë•Œê¹Œì§€ ìˆ˜ì •Â·ë³´ì™„í•œë‹¤

## í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ê°•ì œ ê·œì¹™ (âš ï¸ í•„ìˆ˜ - ì˜ˆì™¸ ì—†ìŒ)

> **ğŸš¨ ì¤‘ìš”**: ì»´í¬ë„ŒíŠ¸ ë° Hook ê°œë°œ ì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ Storybookì€ **ë°˜ë“œì‹œ** í•¨ê»˜ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
> 
> **í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ì—†ì´ PRì„ ì˜¬ë¦¬ë©´ ë¦¬ë·°ê°€ ê±°ë¶€ë©ë‹ˆë‹¤.**
> 
> **í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ì—†ì´ ê°œë°œì„ ì™„ë£Œí–ˆë‹¤ê³  ë§í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.**

### ëŒ€ìƒ íŒŒì¼

| ê²½ë¡œ íŒ¨í„´ | í…ŒìŠ¤íŠ¸ í•„ìˆ˜ | ìŠ¤í† ë¦¬ í•„ìˆ˜ |
|----------|:---------:|:---------:|
| `src/**/ui/*.tsx` (pages/widgets/features/entities) | âœ… | âœ… |
| `src/shared/components/ui/*.tsx` | âœ… | âœ… |
| `src/**/model/*.ts` (hooks/stores) | âœ… | âŒ |

### í•„ìˆ˜ ì‚°ì¶œë¬¼

#### 1. Unit Test (ëª¨ë“  ëŒ€ìƒ íŒŒì¼ í•„ìˆ˜)
- **íŒŒì¼ëª…**: ë™ì¼ ê²½ë¡œì— `*.test.tsx` ë˜ëŠ” `*.test.ts`
- **ìµœì†Œ ìš”êµ¬ì‚¬í•­**:
  - UI ì»´í¬ë„ŒíŠ¸: ë Œë”ë§ í…ŒìŠ¤íŠ¸ + í•µì‹¬ ì¸í„°ë™ì…˜(í´ë¦­/ë¹„í™œì„±/ë¡œë”© ë“±) 1ê°œ ì´ìƒ
  - Hook/Store: ì£¼ìš” ì•¡ì…˜ê³¼ ìƒíƒœ ë³€ê²½ ê²€ì¦

```typescript
// ì˜ˆì‹œ: src/features/match-photo/ui/person-button.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { PersonButton } from './person-button';

describe('PersonButton', () => {
  it('ë Œë”ë§ í…ŒìŠ¤íŠ¸', () => { /* ... */ });
  it('í´ë¦­ ì‹œ onSelect í˜¸ì¶œ', () => { /* ... */ });
  it('ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ onDelete í˜¸ì¶œ', () => { /* ... */ });
});
```

#### 2. Storybook Story (UI ì»´í¬ë„ŒíŠ¸ í•„ìˆ˜)
- **íŒŒì¼ëª…**: ë™ì¼ ê²½ë¡œì— `*.stories.tsx`
- **ìµœì†Œ ìš”êµ¬ì‚¬í•­**:
  - `Default` ìŠ¤í† ë¦¬ í•„ìˆ˜
  - í•µì‹¬ ìƒíƒœ ìŠ¤í† ë¦¬ 1ê°œ ì´ìƒ (ì˜ˆ: `Selected`, `Loading`, `Disabled`, `Error`, `WithPhoto`)

```typescript
// ì˜ˆì‹œ: src/features/match-photo/ui/person-button.stories.tsx
import type { Meta, StoryObj } from '@storybook/react';
import { PersonButton } from './person-button';

const meta: Meta<typeof PersonButton> = { /* ... */ };
export default meta;

export const Default: StoryObj<typeof PersonButton> = {};
export const Active: StoryObj<typeof PersonButton> = {};
export const WithPhoto: StoryObj<typeof PersonButton> = {};
```

### ê°œë°œ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸ (PR ì „ í•„ìˆ˜ í™•ì¸)

**âš ï¸ ì•„ë˜ í•­ëª©ì„ ëª¨ë‘ ì¶©ì¡±í•˜ì§€ ì•Šìœ¼ë©´ ê°œë°œ ì™„ë£Œê°€ ì•„ë‹™ë‹ˆë‹¤:**

- [ ] ê° UI ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•œ `*.test.tsx` íŒŒì¼ ì‘ì„± ì™„ë£Œ
- [ ] ê° Hook/Storeì— ëŒ€í•œ `*.test.ts` íŒŒì¼ ì‘ì„± ì™„ë£Œ
- [ ] `pnpm check` ì‹¤í–‰í•˜ì—¬ Biome ê²€ì‚¬ í†µê³¼ í™•ì¸ (ë¬¸ì œ ë°œìƒ ì‹œ í•´ê²°í•  ë•Œê¹Œì§€ ë°˜ë³µ)
- [ ] `pnpm tsc` ì‹¤í–‰í•˜ì—¬ TypeScript íƒ€ì… ê²€ì‚¬ í†µê³¼ í™•ì¸
- [ ] `pnpm test` ì‹¤í–‰í•˜ì—¬ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸
- [ ] ê° UI ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•œ `*.stories.tsx` íŒŒì¼ ì‘ì„± ì™„ë£Œ
- [ ] `pnpm storybook` ì‹¤í–‰í•˜ì—¬ ëª¨ë“  ìŠ¤í† ë¦¬ ë Œë”ë§ í™•ì¸

### ì˜ˆì™¸ ìƒí™©

- `index.ts` (Public API ë°°ëŸ´ íŒŒì¼): í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ëŒ€ìƒ ì œì™¸
- ìˆœìˆ˜ íƒ€ì… ì •ì˜ íŒŒì¼ (`types.ts`): í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ëŒ€ìƒ ì œì™¸
- ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸: **ìƒíƒœ ì£¼ì…ì´ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì„¤ê³„** í•„ìˆ˜
  - ê¶Œì¥: `Presentational(ui)` + `Controller(model)` ë¶„ë¦¬
  - ë˜ëŠ”: propsë¡œ mock ë°ì´í„°/í•¸ë“¤ëŸ¬ ì£¼ì… ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„


## UI / ë¡œì§ ë¶„ë¦¬ ê·œì¹™ (ì§€ì† ë°˜ì˜)
í™”ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ë¹„ëŒ€í•´ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´, ì•ìœ¼ë¡œ ëª¨ë“  êµ¬í˜„ì—ì„œ UIì™€ ë¡œì§ì„ ë¶„ë¦¬í•˜ëŠ” ì›ì¹™ì„ **ê¸°ë³¸ê°’**ìœ¼ë¡œ ì ìš©í•©ë‹ˆë‹¤.

### ë¡œì§ì€ `model`ë¡œ ì´ë™ (Hook ì¤‘ì‹¬)
- ìƒíƒœ/ì‚¬ì´ë“œì´í™íŠ¸/ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„ì€ í›…ìœ¼ë¡œ ìº¡ìŠí™”í•©ë‹ˆë‹¤.
- ë‹¨, **í•˜ë‚˜ì˜ í›…ì´ ì—¬ëŸ¬ ê´€ì‹¬ì‚¬(ì˜ˆ: ì—…ë¡œë“œ + Step ì „í™˜ + ë¼ìš°íŒ… + í† ìŠ¤íŠ¸)**ë¥¼ ë™ì‹œì— ê°–ì§€ ì•Šë„ë¡, ì•„ë˜ â€œí›… ì±…ì„ ë¶„ë¦¬ ê·œì¹™â€ì„ **ê¸°ë³¸ê°’**ìœ¼ë¡œ ì ìš©í•©ë‹ˆë‹¤.

### UI ì»´í¬ë„ŒíŠ¸ëŠ” â€œí‘œí˜„(Presentational)â€ë¡œ ìœ ì§€
- UI ì»´í¬ë„ŒíŠ¸ëŠ” ê°€ëŠ¥í•œ í•œ props ê¸°ë°˜ìœ¼ë¡œ ë Œë”ë§ë§Œ í•©ë‹ˆë‹¤.
- ê³µí†µ ë²„íŠ¼/í—¤ë” ë“±ì€ ì¬ì‚¬ìš© ëª©ì ì´ ëª…í™•í•˜ë©´ `shared` ë˜ëŠ” `widgets`ë¡œ ì˜¬ë¦½ë‹ˆë‹¤(FSD ì˜ì¡´ì„± ê·œì¹™ ì¤€ìˆ˜).

### í›… ì±…ì„ ë¶„ë¦¬ ê·œì¹™ (ëª¨ë“  ìƒí™© ê³µí†µ)

**ëª©í‘œ**: í›…ì˜ ì±…ì„ì„ â€œë‹¨ì¼ ê´€ì‹¬ì‚¬â€ë¡œ ìª¼ê°œ ì¬ì‚¬ìš©/í…ŒìŠ¤íŠ¸/ë³€ê²½ì— ê°•í•˜ê²Œ ë§Œë“ ë‹¤.

1. **ì½”ì–´ í›… vs ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…ì„ ë¶„ë¦¬í•œë‹¤**
   - **ì½”ì–´ í›…(ë„ë©”ì¸/ìœ í‹¸)**: í•œ ê°€ì§€ ì‘ì—…ë§Œ ì±…ì„ì§„ë‹¤. ì˜ˆ) íŒŒì¼ ì„ íƒ/í”„ë¦¬ë·°/ì—…ë¡œë“œ, í¼ ìƒíƒœ/ê²€ì¦, ì¿¼ë¦¬/ë®¤í…Œì´ì…˜ ì‹¤í–‰
   - **ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…(Flow/Controller)**: ì—¬ëŸ¬ ì½”ì–´ í›…ì„ ì¡°í•©í•˜ê³  â€œí™”ë©´/í”Œë¡œìš° ì •ì±…â€ì„ ê²°ì •í•œë‹¤. ì˜ˆ) Step ì „í™˜, ë¼ìš°íŒ…, í† ìŠ¤íŠ¸/íŠ¸ë˜í‚¹, ì„±ê³µ/ì‹¤íŒ¨ ë¶„ê¸°

2. **Step ì „í™˜/ë¼ìš°íŒ…/ì „ì—­ ìŠ¤í† ì–´ ì—°ë™ì€ ì›ì¹™ì ìœ¼ë¡œ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…ì—ì„œë§Œ í•œë‹¤**
   - ì½”ì–´ í›…ì€ `useStepStore()`, `router.push()` ê°™ì€ â€œì•± í”Œë¡œìš° ê²°ì •â€ ì˜ì¡´ì„±ì„ ì§ì ‘ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤.
   - ì˜ˆì™¸ê°€ í•„ìš”í•˜ë©´ í›… ì´ë¦„/íŒŒì¼ëª…ì— ì˜ë„ë¥¼ ë“œëŸ¬ë‚¸ë‹¤(ì˜ˆ: `useUploadPhotoFlow`, `useSelectModeFlow`).

3. **ê²°í•©ì´ í•„ìš”í•˜ë©´ â€œì½œë°± ì£¼ì…â€ìœ¼ë¡œ ëŠìŠ¨í•˜ê²Œ ì—°ê²°í•œë‹¤**
   - ì½”ì–´ í›…ì€ `onSuccess/onError/onSettled` ë˜ëŠ” ë„ë©”ì¸ì— ë§ëŠ” `onUploaded` ê°™ì€ ì˜µì…˜ì„ ë°›ì•„, ì„±ê³µ/ì‹¤íŒ¨ â€œì‚¬ê±´(event)â€ë§Œ ì™¸ë¶€ë¡œ ë°©ì¶œí•œë‹¤.
   - ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…ì´ ê·¸ ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ Step ì „í™˜/í† ìŠ¤íŠ¸/ì¶”ì ì„ ìˆ˜í–‰í•œë‹¤.

4. **í›…ì˜ ë°˜í™˜ê°’ì€ ìµœì†Œ APIë¡œ ìœ ì§€í•œë‹¤**
   - ë°˜í™˜ê°’ì´ â€œìƒíƒœ + ì•¡ì…˜â€ì„ ë„˜ì–´ ì»¤ì§€ê¸° ì‹œì‘í•˜ë©´(ì˜ˆ: ì•¡ì…˜ì´ 6ê°œ ì´ìƒ, ì„œë¡œ ë‹¤ë¥¸ ì±…ì„ì˜ ìƒíƒœê°€ ì„ì„) í›… ë¶„ë¦¬ë¥¼ ìš°ì„  ê²€í† í•œë‹¤.

5. **íŒŒì¼/ë„¤ì´ë° ê·œì¹™ìœ¼ë¡œ ì˜ë„ë¥¼ ê³ ì •í•œë‹¤**
   - ì½”ì–´ í›…: `use-<domain>.ts` (ì˜ˆ: `use-photo-upload.ts`)
   - ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í›…: `use-<domain>-flow.ts` ë˜ëŠ” `use-<domain>-controller.ts` (ì˜ˆ: `use-upload-photo-flow.ts`)
   - â€œFlow/Controllerâ€ í›…ì€ í•´ë‹¹ Feature/Page ë²”ìœ„ì˜ ì •ì±…ì„ í¬í•¨í•  ìˆ˜ ìˆë‹¤.

## Biome Complexity ê·œì¹™ ëŒ€ì‘

`biome lint/complexity/noExcessiveCognitiveComplexity` ê²½ê³ ë¥¼ ì˜ˆë°©í•˜ê¸° ìœ„í•´, JSX ë‚´ë¶€(íŠ¹íˆ `className`)ì—ì„œ **ì¤‘ì²© ì‚¼í•­ ì—°ì‚°ì** ì‚¬ìš©ì„ ê¸ˆì§€í•©ë‹ˆë‹¤.

- **ìƒíƒœ ë„ì¶œ(Derived State):** ë³µì¡í•œ boolean ì¡°ê±´ë“¤ì€ `render` ì´ì „ì— `status`(ì˜ˆ: `idle | active | error`) ê°™ì€ **ë‹¨ì¼ ë¬¸ìì—´ ìƒíƒœë¡œ ë¨¼ì € ë„ì¶œ**í•©ë‹ˆë‹¤.
- **ë§¤í•‘ ë¶„ë¦¬:** ìŠ¤íƒ€ì¼ ë¡œì§ì€ `status`ë¥¼ í‚¤(key)ë¡œ í•˜ëŠ” **ë§¤í•‘ ê°ì²´(Lookup Table)**ë‚˜ `cva`ì˜ **variants**ë¡œ ìœ„ì„í•©ë‹ˆë‹¤.
- **JSX ë‹¨ìˆœí™”:** JSX ë‚´ë¶€ì—ì„œëŠ” `cn(base, statusMap[status])` í˜•íƒœì˜ **ë‹¨ìˆœ ë³‘í•©**ë§Œ ìˆ˜í–‰í•˜ì—¬ ê°€ë…ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.
- **ë¦¬ì†ŒìŠ¤ ì¼ì›í™”:** í…ìŠ¤íŠ¸ ë¼ë²¨ì´ë‚˜ ì•„ì´ì½˜ ë˜í•œ `status` ê¸°ë°˜ ë§¤í•‘ìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬ ë Œë”ë§ ë¶„ê¸°ë¥¼ ìµœì†Œí™”í•©ë‹ˆë‹¤.

## ì´ë¯¸ì§€ ì»´í¬ë„ŒíŠ¸ ê·œì¹™

- ì´ë¯¸ì§€ë¥¼ ë Œë”ë§í•  ë•ŒëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `next/image`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. (`import Image from 'next/image'`)
- ì˜ˆì™¸: `blob:`/`data:` URL ê¸°ë°˜ í”„ë¦¬ë·°ì²˜ëŸ¼ ìµœì í™” íŒŒì´í”„ë¼ì¸ì„ ì ìš©í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°ì—ëŠ” `unoptimized` ì‚¬ìš© ë˜ëŠ” `<img>` ì‚¬ìš©ì„ í—ˆìš©í•©ë‹ˆë‹¤(ì‚¬ìœ ë¥¼ ëª…í™•íˆ ë‚¨ê¸°ê¸°).

### TypeScript íƒ€ì… ì •ì˜ ê·œì¹™

**enum ì‚¬ìš© ì§€ì–‘ â€” as const íŒ¨í„´ ì‚¬ìš©**:

```typescript
// âŒ Bad - enum ì‚¬ìš©
enum Status {
  BANNED = 'Banned',
  INACTIVE = 'Inactive',
  PENDING = 'Pending',
  ACTIVE = 'Active',
}

// âœ… Good - as const íŒ¨í„´ ì‚¬ìš©
export const Status = {
  BANNED: 'Banned',
  INACTIVE: 'Inactive',
  PENDING: 'Pending',
  ACTIVE: 'Active',
} as const;

export type Status = typeof Status[keyof typeof Status];
```

## ë¼ì´ë¸ŒëŸ¬ë¦¬ ê´€ë¦¬ ê·œì¹™

### Context7 ì‚¬ìš©

**ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° ì‚¬ìš© ì‹œ Context7 í•„ìˆ˜ í™œìš©**:

ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ ì‚¬ìš©í•˜ê¸° ì „ì— ë°˜ë“œì‹œ Context7 MCPë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì‹  ë¬¸ì„œì™€ ì‚¬ìš©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.

**ì ìš© ì˜ˆì‹œ**:
```typescript
// âŒ Bad - Context7 ì¡°íšŒ ì—†ì´ ì„¤ì¹˜
// pnpm add zustand í›„ ì¶”ì¸¡ìœ¼ë¡œ êµ¬í˜„

// âœ… Good - Context7ë¡œ ìµœì‹  ë¬¸ì„œ í™•ì¸ í›„ êµ¬í˜„
// 1. Context7ë¡œ zustand ë¬¸ì„œ ì¡°íšŒ
// 2. ìµœì‹  API ë° Best Practice í™•ì¸
// 3. ì˜¬ë°”ë¥¸ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„
```

**ì£¼ì˜ì‚¬í•­**:
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ë³€ê²½ ì‹œ í•­ìƒ Context7ë¡œ Breaking Changes í™•ì¸
- ìƒˆë¡œìš´ ê¸°ëŠ¥ ì‚¬ìš© ì‹œ Context7ë¡œ ìµœì‹  API ë¬¸ì„œ ì¡°íšŒ
- ì—ëŸ¬ í•´ê²° ì‹œ Context7ë¡œ ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰



<!-- Source: .ruler/ARCHITECTURE.md -->

# LateProof â€” Architecture Documentation

> **ëª©ì **: í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°ì™€ ì•„í‚¤í…ì²˜ íŒ¨í„´ ì •ì˜  
> **ê°±ì‹  ë°©ì‹**: ê¸°ëŠ¥ ê°œë°œ ì™„ë£Œ ì‹œë§ˆë‹¤ ì—…ë°ì´íŠ¸  
> **Last Updated**: 2025-12-18 (EXPRESSION Step í‘œì • ì„ íƒ UI êµ¬í˜„)

---

## 2025-12-18 ì—…ë°ì´íŠ¸
- ì¶”ê°€: `emoji-picker-react` íŒ¨í‚¤ì§€ â€” ì´ëª¨í‹°ì½˜ ì„ íƒ UI
- ë³€ê²½: `src/entities/person/model/types.ts` â€” `ExpressionEmoji` íƒ€ì…ì„ stringìœ¼ë¡œ í™•ì¥, `EXPRESSION_PRESETS` ì¶”ê°€
- ë³€ê²½: `src/entities/person/model/store.ts` â€” `setExpression`, `clearExpression` ì•¡ì…˜ ì¶”ê°€
- ì¶”ê°€: `src/features/expression-select/ui/expression-person-button.tsx` â€” ì¸ë¬¼ ì„ íƒ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸
- ì¶”ê°€: `src/features/expression-select/ui/expression-grid.tsx` â€” emoji-picker-react ê¸°ë°˜ í‘œì • ì„ íƒ UI
- ë³€ê²½: `src/features/expression-select/ui/expression-select-view.tsx` â€” ìƒë‹¨ ì¸ë¬¼ ë²„íŠ¼ + í•˜ë‹¨ í‘œì • ì„ íƒ UI í†µí•©
- ì¶”ê°€: ê° ì»´í¬ë„ŒíŠ¸ë³„ í…ŒìŠ¤íŠ¸ ë° ìŠ¤í† ë¦¬ íŒŒì¼

---

## 2025-12-17 ì—…ë°ì´íŠ¸
- ë³€ê²½: `app/layout.tsx` â€” Sonner `Toaster` ì¶”ê°€(ì „ì—­ í† ìŠ¤íŠ¸ ë Œë”ë§)
- ë³€ê²½: `src/features/match-photo/ui/match-photo-view.tsx` â€” ê²€ì¦ ì‹¤íŒ¨ ë©”ì‹œì§€ `window.alert` â†’ `toast.error`
- ë³€ê²½: `package.json` â€” `sonner` ì˜ì¡´ì„± ì¶”ê°€
- ë³€ê²½: `src/features/match-photo/ui/match-photo-view.test.tsx` â€” ê²€ì¦ ì‹¤íŒ¨ ì‹œ í† ìŠ¤íŠ¸ í˜¸ì¶œ í…ŒìŠ¤íŠ¸ ì¶”ê°€
- ì¶”ê°€: `app/api/face/validate/route.test.ts` â€” MSWë¡œ Azure Face í˜¸ì¶œì„ ëª¨í‚¹í•˜ì—¬ Route Handlerë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- ì¶”ê°€: `mocks/handlers/azure-face.ts` â€” Azure Face `/face/v1.0/detect` ëª¨í‚¹(ìš”ì²­ ë°”ë””ë¡œ ì¼€ì´ìŠ¤ ë¶„ê¸°)
- ë³€ê²½: `mocks/handlers/index.ts` â€” Azure Face í•¸ë“¤ëŸ¬ë¥¼ wildcard ê¸°ë°˜ìœ¼ë¡œ êµì²´
- ë³€ê²½: `vitest.setup.ts` â€” unhandled ì™¸ë¶€ ìš”ì²­ì„ `error`ë¡œ ì²˜ë¦¬(ì™¸ë¶€ API ì‹¤í˜¸ì¶œ ë°©ì§€)
- ì¶”ê°€: `app/api/face/validate/route.ts` â€” Azure Face API(/face/v1.0/detect) í”„ë¡ì‹œ + ì–¼êµ´/ì €í•´ìƒë„ ê²€ì¦
- ì¶”ê°€: `src/features/match-photo/model/validate-face-photo.ts` â€” í”„ë¡ íŠ¸ì—ì„œ ê²€ì¦ API í˜¸ì¶œ(FormData)
- ì¶”ê°€: `src/features/match-photo/model/validate-face-photo.test.ts` â€” ê²€ì¦ API í˜¸ì¶œ ìœ í‹¸ ìœ ë‹› í…ŒìŠ¤íŠ¸
- ë³€ê²½: `src/features/match-photo/ui/match-photo-view.tsx` â€” ì—…ë¡œë“œ/êµì²´ ì‹œ ê²€ì¦ ì„±ê³µ ì‹œì—ë§Œ ì–¼êµ´ ì‚¬ì§„ ì €ì¥
- ë³€ê²½: `.env.example` â€” `AZURE_FACE_ENDPOINT`, `AZURE_FACE_KEY` ì¶”ê°€
- ë³€ê²½: `src/entities/person/model/types.ts` â€” `MarkerTransform.imageScale`(ì–¼êµ´ ì´ë¯¸ì§€ í¬ê¸°) ì¶”ê°€, `PersonForAI.faceImageScale` ë°˜ì˜
- ë³€ê²½: `src/entities/person/model/store.ts` â€” ì¸ë¬¼ ì¶”ê°€ ì‹œ Active ë§ˆì»¤ ê¸°ì¤€ìœ¼ë¡œ "ë°˜ì¯¤ ê²¹ì¹˜ê²Œ" ìš°ì¸¡ ìŠ¤íƒ ë°°ì¹˜
- ë³€ê²½: `src/features/match-photo/ui/person-marker.tsx` â€” ë§ˆì»¤ ë‚´ë¶€ ì–¼êµ´ ì´ë¯¸ì§€ +/- í¬ê¸° ì¡°ì ˆ ì»¨íŠ¸ë¡¤ ì¶”ê°€
- ë³€ê²½: `src/entities/person/model/export-for-ai.ts` â€” AI ì „ë‹¬ ë°ì´í„°ì— ì–¼êµ´ ì´ë¯¸ì§€ ìŠ¤ì¼€ì¼ í¬í•¨ ë° í”„ë¡¬í”„íŠ¸ ì¶œë ¥ ê°œì„ 

## ğŸ“ Project Structure

```
lateproof/
â”œâ”€â”€ .ruler/                    # í”„ë¡œì íŠ¸ ë¬¸ì„œí™” (PRD, SG, TASKS, PLAN, AGENTS)
â”‚   â”œâ”€â”€ AGENTS.md             # AI Agent ì§€ì¹¨
â”‚   â”œâ”€â”€ ARCHITECTURE.md       # ì•„í‚¤í…ì²˜ ë¬¸ì„œ (ë³¸ íŒŒì¼)
â”‚   â”œâ”€â”€ PlAN.md               # êµ¬í˜„ ê³„íš ë° ì§„í–‰ ìƒí™©
â”‚   â”œâ”€â”€ PRD.md                # Product Requirements Document
â”‚   â”œâ”€â”€ SG.md                 # Style Guide
â”‚   â”œâ”€â”€ TASKS.md              # Task ê´€ë¦¬
â”‚   â””â”€â”€ ruler.toml            # Ruler ì„¤ì •
â”‚
â”œâ”€â”€ .storybook/               # Storybook ì„¤ì •
â”‚   â”œâ”€â”€ main.ts               # Storybook ë©”ì¸ ì„¤ì •
â”‚   â””â”€â”€ preview.ts            # ê¸€ë¡œë²Œ ë°ì½”ë ˆì´í„° ë° íŒŒë¼ë¯¸í„°
â”‚
â”œâ”€â”€ .vscode/                  # VSCode ì„¤ì •
â”‚   â””â”€â”€ settings.json         # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì„¤ì •
â”‚
â”œâ”€â”€ app/                      # Next.js App Router (ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ, í˜ì´ì§€)
â”‚   â”œâ”€â”€ app/                  # "/app" ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¼ìš°íŠ¸
â”‚   â”‚   â””â”€â”€ page.tsx          # StepRouter ë Œë”ë§
â”‚   â”œâ”€â”€ api/                  # Next.js Route Handlers (ì„œë²„ ì „ìš© API)
â”‚   â”‚   â””â”€â”€ face/
â”‚   â”‚       â””â”€â”€ validate/
â”‚   â”‚           â””â”€â”€ route.ts   # Azure Face ê¸°ë°˜ ì–¼êµ´ ê²€ì¦ API
â”‚   â”œâ”€â”€ globals.css           # ì „ì—­ ìŠ¤íƒ€ì¼ (Tailwind CSS)
â”‚   â”œâ”€â”€ layout.tsx            # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ page.tsx              # "/" ë£¨íŠ¸ í˜ì´ì§€ (ëœë”©í˜ì´ì§€ ì˜ˆì •, í˜„ì¬ /app ë¦¬ë‹¤ì´ë ‰íŠ¸)
â”‚
â”œâ”€â”€ e2e/                      # Playwright E2E í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ example.spec.ts       # ì˜ˆì œ E2E í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ README.md             # E2E í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ
â”‚
â”œâ”€â”€ mocks/                    # MSW (Mock Service Worker)
â”‚   â”œâ”€â”€ handlers/             # API Mock í•¸ë“¤ëŸ¬
â”‚   â”‚   â”œâ”€â”€ azure-face.ts     # Azure Face API í•¸ë“¤ëŸ¬
â”‚   â”‚   â””â”€â”€ index.ts          # í•¸ë“¤ëŸ¬ ì •ì˜
â”‚   â”œâ”€â”€ browser.ts            # ë¸Œë¼ìš°ì € í™˜ê²½ MSW ì„¤ì •
â”‚   â”œâ”€â”€ node.ts               # Node í™˜ê²½ MSW ì„¤ì •
â”‚   â””â”€â”€ README.md             # MSW ì‚¬ìš© ê°€ì´ë“œ
â”‚
â”œâ”€â”€ pages/                    # ê¸°íƒ€ í˜ì´ì§€ (í•„ìš”ì‹œ ì‚¬ìš©)
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ public/                   # ì •ì  íŒŒì¼ (ì´ë¯¸ì§€, í°íŠ¸ ë“±)
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ src/                      # ì†ŒìŠ¤ ì½”ë“œ (FSD ì•„í‚¤í…ì²˜)
â”‚   â”œâ”€â”€ app/                  # App Layer (ì•± ì´ˆê¸°í™”, í”„ë¡œë°”ì´ë”, ë¼ìš°íŒ…)
â”‚   â”‚   â”œâ”€â”€ router/           # Step ê¸°ë°˜ ë¼ìš°í„° (Segment)
â”‚   â”‚   â”‚   â”œâ”€â”€ step-router.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts      # Public API
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ entities/             # Entities Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹°, ì½ê¸° ì „ìš©)
â”‚   â”‚   â”œâ”€â”€ photo/            # Photo ì—”í‹°í‹° (ì„ íƒëœ íŒŒì¼ ìƒíƒœ)
â”‚   â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.test.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ step/             # Step ì—”í‹°í‹° (ì›Œí¬í”Œë¡œìš° ìƒíƒœ ê´€ë¦¬)
â”‚   â”‚   â”‚   â”œâ”€â”€ model/        # ë„ë©”ì¸ ëª¨ë¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ step.ts   # Step as const, STEP_META, STEP_ORDER
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ transition.ts  # FSM Transition Table
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts  # Mode, StepState, StepTransitionContext
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.ts  # Step FSM Store (Zustand)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.test.ts  # Store Unit Test (17 tests)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts  # model Public API
â”‚   â”‚   â”‚   â””â”€â”€ index.ts      # entity Public API
â”‚   â”‚   â”œâ”€â”€ person/           # Person ì—”í‹°í‹° (ì¸ë¬¼ ë§ˆì»¤ ìƒíƒœ ê´€ë¦¬) - Epic 2.4
â”‚   â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts      # PersonColor, MarkerTransform, Person, PersonState
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ export-for-ai.ts   # MATCH Step AI ì „ë‹¬ìš© ë³€í™˜ ìœ í‹¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ export-for-ai.test.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.ts      # Person Store (Zustand) - ìµœëŒ€ 5ëª…, ì´ˆê¸°í™”/ì¬ì´ˆê¸°í™”
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ store.test.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts      # model Public API
â”‚   â”‚   â”‚   â””â”€â”€ index.ts          # entity Public API
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ features/             # Features Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥, ì“°ê¸° ì‘ì—…)
â”‚   â”‚   â”œâ”€â”€ select-mode/      # ëª¨ë“œ ì„ íƒ ê¸°ëŠ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/           # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mode-card.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mode-card.test.tsx (7 tests)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mode-card.stories.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ select-mode-view.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ upload-photo/     # ì‚¬ì§„ ì—…ë¡œë“œ ê¸°ëŠ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ upload-dropzone.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ upload-photo-view.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ match-photo/      # ì¸ë¬¼ ë§ˆì»¤ ë°°ì¹˜ ê¸°ëŠ¥ (Epic 2.4)
â”‚   â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ validate-face-photo.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ validate-face-photo.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-marker.tsx      # ì´ë¯¸ì§€ ìœ„ ë§ˆì»¤ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-marker.test.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-marker.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-button.tsx      # í•˜ë‹¨ ì‚¬ëŒ ë²„íŠ¼
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-button.test.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-button.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ add-person-button.tsx  # ì‚¬ëŒ ì¶”ê°€ ë²„íŠ¼
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ add-person-button.test.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ add-person-button.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-list-panel.tsx  # í•˜ë‹¨ ì‚¬ëŒ ëª©ë¡ íŒ¨ë„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-list-panel.test.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ person-list-panel.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ image-canvas.tsx       # ë² ì´ìŠ¤ ì´ë¯¸ì§€ + ë§ˆì»¤ ì˜¤ë²„ë ˆì´
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ image-canvas.test.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ image-canvas.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ match-photo-view.tsx   # ë§¤ì¹­ ë©”ì¸ ë·°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ match-photo-view.test.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ match-photo-view.stories.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ expression-select/ # í‘œì • ì„ íƒ ê¸°ëŠ¥ (Epic 2.5)
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ expression-select-view.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ expression-select-view.test.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ expression-select-view.stories.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                # Pages Layer (í˜ì´ì§€ ì¡°í•©)
â”‚   â”‚   â”œâ”€â”€ select-mode/      # ëª¨ë“œ ì„ íƒ í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ select-mode-page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ upload-photo/     # ì‚¬ì§„ ì—…ë¡œë“œ í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ upload-photo-page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ match-photo/      # ì¸ë¬¼ ë§¤ì¹­ í˜ì´ì§€ (Epic 2.4)
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ match-photo-page.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ match-photo-page.test.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ match-photo-page.stories.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ expression-select/ # í‘œì • ì„ íƒ í˜ì´ì§€ (Epic 2.5)
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ expression-select-page.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ expression-select-page.test.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ expression-select-page.stories.tsx
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/               # Shared Layer (ê³µí†µ ì½”ë“œ)
â”‚   â”‚   â”œâ”€â”€ components/       # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ ui/           # Shadcn/UI ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ button.test.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ button.stories.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ next-step-button.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ next-step-button.test.tsx
â”‚   â”‚   â”‚       â””â”€â”€ next-step-button.stories.tsx
â”‚   â”‚   â””â”€â”€ lib/              # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”‚       â”œâ”€â”€ utils.ts      # cn() ë“± ìœ í‹¸ í•¨ìˆ˜
â”‚   â”‚       â”œâ”€â”€ index.ts
â”‚   â”‚       â””â”€â”€ example.test.ts
â”‚   â”‚
â”‚   â””â”€â”€ widgets/              # Widgets Layer (ë³µí•© UI ë¸”ë¡)
â”‚       â”œâ”€â”€ step-header/      # Step ê³µí†µ í—¤ë” ìœ„ì ¯
â”‚       â”‚   â”œâ”€â”€ ui/
â”‚       â”‚   â”‚   â”œâ”€â”€ step-header.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ step-header.test.tsx
â”‚       â”‚   â”‚   â””â”€â”€ step-header.stories.tsx
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ .env.example              # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ .gitignore                # Git ì œì™¸ íŒŒì¼
â”œâ”€â”€ biome.json                # Biome ì„¤ì • (Lint/Format)
â”œâ”€â”€ components.json           # Shadcn/UI ì„¤ì •
â”œâ”€â”€ lefthook.yml              # Git Hooks ì„¤ì •
â”œâ”€â”€ next.config.ts            # Next.js ì„¤ì •
â”œâ”€â”€ package.json              # íŒ¨í‚¤ì§€ ì˜ì¡´ì„±
â”œâ”€â”€ playwright.config.ts      # Playwright ì„¤ì •
â”œâ”€â”€ postcss.config.mjs        # PostCSS ì„¤ì •
â”œâ”€â”€ README.md                 # í”„ë¡œì íŠ¸ README
â”œâ”€â”€ tsconfig.json             # TypeScript ì„¤ì •
â”œâ”€â”€ vitest.config.ts          # Vitest ì„¤ì •
â””â”€â”€ vitest.setup.ts           # Vitest Setup íŒŒì¼
```

---

## ğŸ—ï¸ Architecture Patterns

### FSD (Feature-Sliced Design)

í”„ë¡œì íŠ¸ëŠ” **FSD ì•„í‚¤í…ì²˜**ë¥¼ ë”°ë¥¸ë‹¤. FSDëŠ” ê³„ì¸µí˜• êµ¬ì¡°ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ë¦¬í•˜ë©°, `processes` LayerëŠ” ì œê±°ë˜ì—ˆë‹¤.

#### FSD êµ¬ì¡° ê·œì¹™

**ì¼ë°˜ Layer** (pages, widgets, features, entities):
```
Layer â†’ Slice â†’ Segment
ì˜ˆ: entities/user/model
    features/auth/ui
    pages/home/ui
```

**íŠ¹ìˆ˜ Layer** (app, shared):
```
Layer â†’ Segment (Slice ì—†ìŒ)
ì˜ˆ: app/router
    app/providers
    shared/ui
    shared/lib
```

**ì¤‘ìš”**: `app`ê³¼ `shared` LayerëŠ” **Slices ì—†ì´ ë°”ë¡œ Segments**ë¡œ êµ¬ì„±ëœë‹¤.

#### Layer ì •ì˜

| Layer | ì—­í•  | ì˜ì¡´ì„± ë°©í–¥ |
|-------|-----|-----------|
| **app** | ì•± ì´ˆê¸°í™”, í”„ë¡œë°”ì´ë”, ë¼ìš°íŒ… ì„¤ì • | â†’ pages, features, entities, shared |
| **pages** | í˜ì´ì§€ ë‹¨ìœ„ ì¡°í•© | â†’ features, entities, widgets, shared |
| **widgets** | ë³µí•© UI ë¸”ë¡ (í—¤ë”, í‘¸í„° ë“±) | â†’ features, entities, shared |
| **features** | ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ (ì“°ê¸° ì‘ì—…, Server Actions) | â†’ entities, shared |
| **entities** | ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° (ì½ê¸° ì‘ì—…, ìˆœìˆ˜ UI) | â†’ shared |
| **shared** | ê³µí†µ ì½”ë“œ (UI ì»´í¬ë„ŒíŠ¸, ìœ í‹¸, í›…) | ì—†ìŒ (ìµœí•˜ìœ„) |

#### ì˜ì¡´ì„± ê·œì¹™

- **ìƒìœ„ LayerëŠ” í•˜ìœ„ Layerë§Œ ì°¸ì¡° ê°€ëŠ¥**
- **ê°™ì€ Layer ê°„ ì°¸ì¡° ê¸ˆì§€**
- **í•˜ìœ„ LayerëŠ” ìƒìœ„ Layerë¥¼ ì ˆëŒ€ ì°¸ì¡° ë¶ˆê°€**

```
app â†’ pages â†’ widgets â†’ features â†’ entities â†’ shared
                    â†˜            â†—
```

---

## ğŸ“‚ Directory Details

### `.ruler/` â€” í”„ë¡œì íŠ¸ ë¬¸ì„œí™”

í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ë¬¸ì„œë¥¼ ì¤‘ì•™ ê´€ë¦¬í•œë‹¤. AI Agentê°€ ì°¸ì¡°í•˜ëŠ” í•µì‹¬ ë¬¸ì„œ.

- `PRD.md`: ì œí’ˆ ìš”êµ¬ì‚¬í•­ ì •ì˜
- `SG.md`: ìŠ¤íƒ€ì¼ ê°€ì´ë“œ (ìƒ‰ìƒ, íƒ€ì´í¬ê·¸ë˜í”¼, Stealth UX)
- `TASKS.md`: Milestone/Epic/Task ê´€ë¦¬
- `PlAN.md`: êµ¬í˜„ ê³„íš ë° ì§„í–‰ ìƒí™©
- `AGENTS.md`: AI Agent ì§€ì¹¨
- `ARCHITECTURE.md`: ì•„í‚¤í…ì²˜ ë¬¸ì„œ (ë³¸ íŒŒì¼)
- `ruler.toml`: Ruler ë„êµ¬ ì„¤ì •

---

### `app/` â€” Next.js App Router

Next.js 15 App Routerì˜ ë£¨íŠ¸ ë ˆì´ì•„ì›ƒê³¼ í˜ì´ì§€.

**ë¼ìš°íŒ… êµ¬ì¡°**:
- `/` (ë£¨íŠ¸): `app/page.tsx` â€” ëœë”©í˜ì´ì§€ (ë‹¤ìŒ ì»¤ë°‹, í˜„ì¬ëŠ” /app ë¦¬ë‹¤ì´ë ‰íŠ¸)
- `/app`: `app/app/page.tsx` â€” ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ (StepRouter ë Œë”ë§)

**íŒŒì¼ ì—­í• **:
- `layout.tsx`: ì „ì—­ ë ˆì´ì•„ì›ƒ (ë©”íƒ€ë°ì´í„°, í°íŠ¸, í”„ë¡œë°”ì´ë”)
- `page.tsx`: ë£¨íŠ¸ í˜ì´ì§€ (`/`)
- `app/page.tsx`: ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ í˜ì´ì§€ (`/app`)
- `globals.css`: Tailwind CSS ì „ì—­ ìŠ¤íƒ€ì¼

---

### `src/app/` â€” App Layer (FSD)

ì•± ì´ˆê¸°í™”, ì „ì—­ í”„ë¡œë°”ì´ë”, ë¼ìš°íŒ… ì„¤ì •.

**í˜„ì¬ êµ¬ì¡°** (FSD ê·œì¹™ ì¤€ìˆ˜):
```
src/app/
â”œâ”€â”€ router/             # Segment: Step ê¸°ë°˜ ë¼ìš°í„°
â”‚   â”œâ”€â”€ step-router.tsx # FSM ê¸°ë°˜ í˜ì´ì§€ ë¼ìš°íŒ…
â”‚   â””â”€â”€ index.ts        # Public API
â””â”€â”€ README.md
```

**ì˜ˆì •ëœ í™•ì¥**:
```
src/app/
â”œâ”€â”€ router/             # Segment: Step ê¸°ë°˜ ë¼ìš°í„°
â”‚   â”œâ”€â”€ step-router.tsx
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ providers/          # Segment: React Query Provider (ì˜ˆì •)
â”‚   â”œâ”€â”€ query-provider.tsx
â”‚   â””â”€â”€ index.ts
â””â”€â”€ README.md
```

**FSD êµ¬ì¡° ê·œì¹™**: `app` LayerëŠ” Slices ì—†ì´ ë°”ë¡œ Segmentsë¡œ êµ¬ì„± (router, providers ë“±)

**ì—­í• **:
- **Step ê¸°ë°˜ ë¼ìš°íŒ…**: `router/step-router.tsx`ê°€ ì—¬ëŸ¬ Pagesë¥¼ ì¡°í•©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ íë¦„ ì œì–´
- ì „ì—­ í”„ë¡œë°”ì´ë” ì„¤ì • (React Query, Theme ë“±)
- ì•± ë ˆë²¨ ë¼ìš°íŒ… ë° ë ˆì´ì•„ì›ƒ êµ¬ì„±
- **ì—”í‹°í‹°ë³„ StoreëŠ” ê° entitiesì— í¬í•¨** (ì˜ˆ: Step Store â†’ entities/step/model/store.ts)

**ì˜ì¡´ì„± íë¦„**:
```
app/app/page.tsx (Next.js App Router)
  â†“
src/app/router/step-router.tsx (App Layer)
  â†“
src/pages/select-mode/ (Pages Layer)
src/pages/upload/ (ì˜ˆì •)
src/pages/match/ (ì˜ˆì •)
...
```

**Public API ë…¸ì¶œ**:
```typescript
// src/app/router/index.ts
export { StepRouter } from './step-router';

// app/app/page.tsxì—ì„œ ì‚¬ìš©
import { StepRouter } from '@/app/router';
```

---

### `src/entities/` â€” Entities Layer (FSD)

ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° ì •ì˜. **ì½ê¸° ì „ìš© ì‘ì—… (GET)** ì¤‘ì‹¬.

**í˜„ì¬ êµ¬ì¡°**:
```
src/entities/
â”œâ”€â”€ photo/              # Photo ì—”í‹°í‹° (ì„ íƒëœ íŒŒì¼ ìƒíƒœ)
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ store.ts        # Photo Store (Zustand)
â”‚   â”‚   â”œâ”€â”€ store.test.ts   # Store Unit Test
â”‚   â”‚   â””â”€â”€ index.ts        # model Public API
â”‚   â””â”€â”€ index.ts            # entity Public API
â”œâ”€â”€ step/               # Step ì—”í‹°í‹° (ì›Œí¬í”Œë¡œìš° FSM)
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ step.ts     # Step as const íŒ¨í„´, STEP_META, STEP_ORDER
â”‚   â”‚   â”œâ”€â”€ transition.ts  # TRANSITION_TABLE, canTransition, validateTransition
â”‚   â”‚   â”œâ”€â”€ types.ts    # Mode, StepState, StepTransitionContext
â”‚   â”‚   â”œâ”€â”€ store.ts    # Step FSM Store (Zustand)
â”‚   â”‚   â”œâ”€â”€ store.test.ts  # Store Unit Test (17 tests)
â”‚   â”‚   â””â”€â”€ index.ts    # model Public API
â”‚   â””â”€â”€ index.ts        # entity Public API
â””â”€â”€ README.md
```

**Photo Entity ìƒì„¸**:
- **store.ts** (Zustand Photo Store):
  - `usePhotoStore`: ì„ íƒëœ `File`ì„ Step ê°„ ìœ ì§€í•˜ê¸° ìœ„í•œ Store
  - `setFile()`: ì„ íƒ íŒŒì¼ ì €ì¥
  - `clear()`: ì´ˆê¸°í™”
  - Selectors: `selectPhotoFile`

**Step Entity ìƒì„¸**:
- **step.ts**: 
  - `Step` (as const íŒ¨í„´): `SELECT_MODE`, `UPLOAD`, `MATCH`, `EXPRESSION`, `PAYMENT`, `GENERATE`, `RESULT`
  - `STEP_META`: ê° Stepì˜ í•œê¸€ ë¼ë²¨, ì§„í–‰ë¥ (0~100), ë’¤ë¡œê°€ê¸° ê°€ëŠ¥ ì—¬ë¶€
  - `STEP_ORDER`: Step ìˆœì„œ ë°°ì—´
- **transition.ts**:
  - `TRANSITION_TABLE`: FSM ê¸°ë°˜ Step ì „í™˜ ê·œì¹™ ì •ì˜
  - `canTransition()`: Step ì „í™˜ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
  - `validateTransition()`: ì „í™˜ ê²€ì¦ (ì‹¤íŒ¨ ì‹œ `TransitionError`)
  - `getNextSteps()`: í˜„ì¬ Stepì—ì„œ ì´ë™ ê°€ëŠ¥í•œ Step ëª©ë¡ ì¡°íšŒ
- **types.ts**:
  - `Mode`: `PHOTO` | `MAP` (ëª¨ë“œ ì„ íƒ)
  - `StepState`: í˜„ì¬ Step, ì„ íƒ ëª¨ë“œ, ì „í™˜ íˆìŠ¤í† ë¦¬
  - `StepTransitionContext`: Step ì „í™˜ ì»¨í…ìŠ¤íŠ¸ (from, to, timestamp, reason)
- **store.ts** (Zustand FSM Store):
  - `useStepStore`: Zustand FSM Store (devtools í¬í•¨)
  - `setMode()`: ëª¨ë“œ ì„ íƒ (PHOTO | MAP)
  - `nextStep()`: Transition Table ê²€ì¦ í›„ Step ì „í™˜
  - `prevStep()`: íˆìŠ¤í† ë¦¬ ê¸°ë°˜ ì´ì „ Step ë³µì›
  - `reset()`: Store ì´ˆê¸°í™”
  - Selectors: `selectCurrentStep`, `selectMode`, `selectHistory`, `selectCanGoBack`
- **store.test.ts**: 17ê°œ Unit Test (Selector í…ŒìŠ¤íŠ¸ í¬í•¨, ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼)

**ì˜ˆì •ëœ ì¶”ê°€ Entity**:
```
src/entities/
â”œâ”€â”€ image/              # ì´ë¯¸ì§€ ì—”í‹°í‹° (ì˜ˆì •)
â”‚   â”œâ”€â”€ model/          # íƒ€ì… ì •ì˜
â”‚   â””â”€â”€ ui/             # ì´ë¯¸ì§€ ë·°ì–´ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ payment/            # ê²°ì œ ì—”í‹°í‹° (ì˜ˆì •)
    â””â”€â”€ model/          # ê²°ì œ ìƒíƒœ íƒ€ì…
```

**Person Entity ìƒì„¸ (Epic 2.4 ì‹ ê·œ)**:
- **types.ts**:
  - `PersonColor`: 5ê°€ì§€ ê³ ì • ìƒ‰ìƒ (BLUE, PURPLE, RED, YELLOW, GREEN)
  - `PERSON_COLOR_ORDER`: ìƒ‰ìƒ ë°°ì • ìˆœì„œ
  - `PERSON_COLOR_VALUES`: CSS í´ë˜ìŠ¤ ë§¤í•‘
  - `MarkerTransform`: ì •ê·œí™” ì¢Œí‘œ(0~1), ìŠ¤ì¼€ì¼, íšŒì „ê°’
  - `Person`: ì‚¬ëŒ ë°ì´í„° (id, color, facePhoto, transform)
  - `PersonState`: Store ìƒíƒœ (persons, activePersonId, initialized)
- **store.ts** (Zustand Person Store):
  - `usePersonStore`: ì¸ë¬¼ ë§ˆì»¤ ìƒíƒœ ê´€ë¦¬
  - `initialize()`: MATCH ìµœì´ˆ ì§„ì… ì‹œ ì´ˆê¸°í™” (EXPRESSIONì—ì„œ ëŒì•„ì˜¬ ë•Œ ìŠ¤í‚µ)
  - `reinitialize()`: ì´ˆê¸°í™” ë²„íŠ¼ìš© ê°•ì œ ì¬ì´ˆê¸°í™”
  - `addPerson()`: ì‚¬ëŒ ì¶”ê°€ (ìµœëŒ€ 5ëª…, ê³ ì • ìƒ‰ìƒ ìˆœì„œ)
  - `removePerson()`: ì‚¬ëŒ ì‚­ì œ (ìµœì†Œ 1ëª… ìœ ì§€)
  - `setActivePerson()`: Active ì‚¬ëŒ ë³€ê²½
  - `setFacePhoto()`: ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ
  - `updateTransform()`: ë§ˆì»¤ ìœ„ì¹˜/ìŠ¤ì¼€ì¼/íšŒì „ ì—…ë°ì´íŠ¸
  - Selectors: `selectPersons`, `selectActivePersonId`, `selectCanAddPerson` ë“±

---

### `src/features/` â€” Features Layer (FSD)

ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ êµ¬í˜„. **ì“°ê¸° ì‘ì—… (POST/PUT/DELETE, Server Actions)** ì¤‘ì‹¬.

**í˜„ì¬ êµ¬ì¡°**:
```
src/features/
â”œâ”€â”€ select-mode/        # ëª¨ë“œ ì„ íƒ ê¸°ëŠ¥ (Epic 2.2 ì™„ë£Œ)
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ mode-card.tsx           # Photo/Map ì„ íƒ ì¹´ë“œ
â”‚   â”‚   â”œâ”€â”€ mode-card.test.tsx      # 7 unit tests
â”‚   â”‚   â”œâ”€â”€ mode-card.stories.tsx   # 4 Storybook stories
â”‚   â”‚   â”œâ”€â”€ select-mode-view.tsx    # ëª¨ë“œ ì„ íƒ ë·°(Presentational)
â”‚   â”‚   â”œâ”€â”€ select-mode-view.test.tsx
â”‚   â”‚   â””â”€â”€ select-mode-view.stories.tsx
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ upload-photo/       # ì‚¬ì§„ ì—…ë¡œë“œ ê¸°ëŠ¥ (Epic 2.3 ì§„í–‰ ì¤‘)
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ file.ts                # íŒŒì¼ ì œì•½(í¬ê¸°/íƒ€ì…)
â”‚   â”‚   â”œâ”€â”€ use-upload-dropzone.ts # Dropzone ë¡œì§ í›…(react-dropzone ë˜í•‘)
â”‚   â”‚   â”œâ”€â”€ use-photo-upload.ts    # ì—…ë¡œë“œ í›…(íŒŒì¼ ì„ íƒ/í”„ë¦¬ë·°/ì—…ë¡œë“œ)
â”‚   â”‚   â””â”€â”€ use-upload-photo-flow.ts # Step ì „í™˜ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜(ì„±ê³µ ì½œë°± ì£¼ì…)
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ helper-text.tsx
â”‚   â”‚   â”œâ”€â”€ helper-text.test.tsx
â”‚   â”‚   â”œâ”€â”€ helper-text.stories.tsx
â”‚   â”‚   â”œâ”€â”€ photo-preview.tsx       # ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°(Next Image, blob í”„ë¦¬ë·°ëŠ” unoptimized)
â”‚   â”‚   â”œâ”€â”€ photo-preview.test.tsx
â”‚   â”‚   â”œâ”€â”€ photo-preview.stories.tsx
â”‚   â”‚   â”œâ”€â”€ upload-dropzone.tsx     # Dropzone UI (presentational)
â”‚   â”‚   â”œâ”€â”€ upload-dropzone.test.tsx
â”‚   â”‚   â”œâ”€â”€ upload-dropzone.stories.tsx
â”‚   â”‚   â”œâ”€â”€ upload-photo-view.tsx   # ì—…ë¡œë“œ ë·° (flow ì£¼ì… ê°€ëŠ¥)
â”‚   â”‚   â”œâ”€â”€ upload-photo-view.test.tsx
â”‚   â”‚   â””â”€â”€ upload-photo-view.stories.tsx
â”‚   â””â”€â”€ index.ts
â””â”€â”€ README.md
```

**select-mode Feature ìƒì„¸**:
- **mode-card.tsx**:
  - Photo/Map ëª¨ë“œ ì„ íƒ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
  - Framer Motion ì• ë‹ˆë©”ì´ì…˜ (whileHover, whileTap)
  - ë¸Œëœë“œ Purple ìƒ‰ìƒ ì‹œìŠ¤í…œ
  - Stealth UX ì¤€ìˆ˜ (ìì—°ìŠ¤ëŸ¬ìš´ ì–¸ì–´)
  - Props: icon, title, description, badge, onClick, isSelected
- **select-mode-view.tsx**:
  - ëª¨ë“œ ì„ íƒ í™”ë©´ ì „ì²´ UI
  - props ê¸°ë°˜(Presentational)ìœ¼ë¡œ ë Œë”ë§ë§Œ ìˆ˜í–‰
  - ì„ íƒ ì´ë²¤íŠ¸ë§Œ ì™¸ë¶€ë¡œ ë°©ì¶œ (`setSelectedMode`)

**Features Layer íŒë‹¨ ê¸°ì¤€**:

Features LayerëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤:
1. **ì‚¬ìš©ì ì˜ë„ ì¡´ì¬**: ì„ íƒ, ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ë“±ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œë‚˜ë¦¬ì˜¤
2. **ì“°ê¸° ì‘ì—… ìˆ˜í–‰**: POST/PUT/DELETE, Server Actions, Store ìƒíƒœ ë³€ê²½
3. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í¬í•¨**: ë‹¨ìˆœ í‘œì‹œê°€ ì•„ë‹Œ ì‹¤ì œ ê¸°ëŠ¥ êµ¬í˜„

**ì˜ˆì‹œ**:
```typescript
// âœ… features/select-mode (í˜„ì¬ êµ¬ì¡°)
// - ì‚¬ìš©ì ì˜ë„: Photo/Map ëª¨ë“œ ì„ íƒ
// - ì“°ê¸° ì‘ì—…: setMode(), nextStep()
// - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: ëª¨ë“œ ì„ íƒ â†’ ê²€ì¦ â†’ Store ì—…ë°ì´íŠ¸ â†’ Step ì „í™˜

export function SelectModeView() {
  const { setMode, nextStep } = useStepStore();
  
  const handleNext = () => {
    setMode(selectedMode);  // â† ì“°ê¸°
    nextStep();             // â† ì“°ê¸°
  };
}

// âŒ entities â€” ì½ê¸°ë§Œ ìˆ˜í–‰
export function ModeDisplay() {
  const mode = useStepStore(selectMode);  // â† ì½ê¸°ë§Œ
  return <div>{mode}</div>;
}

// âŒ widgets â€” ì—¬ëŸ¬ features/entities ì¡°í•©
export function Header() {
  return (
    <header>
      <StepIndicator />  // â† ì¡°í•©
      <UserMenu />       // â† ì¡°í•©
    </header>
  );
}
```

**ì˜ˆì •ëœ ì¶”ê°€ Feature**:
```
src/features/
â”œâ”€â”€ upload-image/       # ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ (ì˜ˆì •)
â”‚   â”œâ”€â”€ ui/             # Dropzone ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ api/            # Server Action
â”œâ”€â”€ match-faces/        # ì–¼êµ´ ë§¤ì¹­ ê¸°ëŠ¥ (ì˜ˆì •)
â”‚   â”œâ”€â”€ ui/             # ì› ì„ íƒ UI
â”‚   â””â”€â”€ lib/            # ì¢Œí‘œ ê³„ì‚° ë¡œì§
â”œâ”€â”€ verify-face/        # ì–¼êµ´ ê²€ì¦ ê¸°ëŠ¥ (ì˜ˆì •)
â”‚   â””â”€â”€ api/            # Azure Face API Wrapper
â”œâ”€â”€ process-payment/    # ê²°ì œ ì²˜ë¦¬ ê¸°ëŠ¥ (ì˜ˆì •)
â”‚   â””â”€â”€ api/            # Toss Payments ì—°ë™
â””â”€â”€ generate-image/     # ì´ë¯¸ì§€ ìƒì„± ê¸°ëŠ¥ (ì˜ˆì •)
    â”œâ”€â”€ ui/             # ìƒì„± ê²°ê³¼ UI
    â””â”€â”€ api/            # Nanobanana API Wrapper
```

---

### `src/pages/` â€” Pages Layer (FSD)

í˜ì´ì§€ ë‹¨ìœ„ ì¡°í•©. Featuresì™€ Entitiesë¥¼ ì¡°í•©í•˜ì—¬ ì™„ì „í•œ í˜ì´ì§€ êµ¬ì„±.

**í˜„ì¬ êµ¬ì¡°**:
```
src/pages/
â”œâ”€â”€ select-mode/        # ëª¨ë“œ ì„ íƒ í˜ì´ì§€ (Epic 2.2 ì™„ë£Œ)
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ select-mode-page.tsx
â”‚   â”‚   â”œâ”€â”€ select-mode-page.test.tsx
â”‚   â”‚   â””â”€â”€ select-mode-page.stories.tsx
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ upload-photo/       # ì‚¬ì§„ ì—…ë¡œë“œ í˜ì´ì§€ (Epic 2.3 ì§„í–‰ ì¤‘)
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ upload-photo-page.tsx
â”‚   â”‚   â”œâ”€â”€ upload-photo-page.test.tsx
â”‚   â”‚   â””â”€â”€ upload-photo-page.stories.tsx
â”‚   â””â”€â”€ index.ts
â””â”€â”€ README.md
```

**select-mode Page ìƒì„¸**:
- **select-mode-page.tsx**:
  - SelectModeView featureë¥¼ ì¡°í•©í•œ ì™„ì „í•œ í˜ì´ì§€
  - FSD Pages Layer ì—­í•  ìˆ˜í–‰
  - app/page.tsxì—ì„œ StepRouterë¥¼ í†µí•´ ë Œë”ë§

**ì˜ˆì •ëœ ì¶”ê°€ Page**:
```
src/pages/
â”œâ”€â”€ match/              # ë§¤ì¹­ í˜ì´ì§€ (ì˜ˆì •)
â”œâ”€â”€ payment/            # ê²°ì œ í˜ì´ì§€ (ì˜ˆì •)
â””â”€â”€ result/             # ê²°ê³¼ í˜ì´ì§€ (ì˜ˆì •)
```

---

### `src/widgets/` â€” Widgets Layer (FSD)

ë³µí•© UI ë¸”ë¡. ì—¬ëŸ¬ Featuresì™€ Entitiesë¥¼ ì¡°í•©í•œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ë‹¨ìœ„.

**í˜„ì¬ êµ¬ì¡°**:
```
src/widgets/
â”œâ”€â”€ step-header/        # Step ê³µí†µ í—¤ë” ìœ„ì ¯
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ step-header.tsx
â”‚   â”‚   â”œâ”€â”€ step-header.test.tsx
â”‚   â”‚   â””â”€â”€ step-header.stories.tsx
â”‚   â””â”€â”€ index.ts
â””â”€â”€ README.md
```

**ì˜ˆì •ëœ Widget**:
```
src/widgets/
â”œâ”€â”€ header/             # í—¤ë” (ì˜ˆì •)
â”œâ”€â”€ step-indicator/     # Step ì§„í–‰ í‘œì‹œê¸° (ì˜ˆì •)
â””â”€â”€ result-card/        # ê²°ê³¼ ì´ë¯¸ì§€ ì¹´ë“œ (ì˜ˆì •)
```

**ì°¸ê³ **: Step RouterëŠ” App Layer (`src/app/router/`)ë¡œ ì´ë™ë¨ (ì—¬ëŸ¬ Pagesë¥¼ ì¡°í•©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ ë¼ìš°íŒ… ë‹´ë‹¹)

---

### `src/shared/` â€” Shared Layer (FSD)

ê³µí†µ ì½”ë“œ. í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ ì¬ì‚¬ìš©ë˜ëŠ” UI ì»´í¬ë„ŒíŠ¸, ìœ í‹¸, í›…, ìƒìˆ˜.

**í˜„ì¬ êµ¬ì¡°**:
```
src/shared/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ui/             # Shadcn/UI ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ button.tsx
â”‚       â”œâ”€â”€ button.test.tsx
â”‚       â””â”€â”€ button.stories.tsx
â””â”€â”€ lib/
    â”œâ”€â”€ utils.ts        # cn() ë“± ìœ í‹¸ í•¨ìˆ˜
    â”œâ”€â”€ index.ts
    â””â”€â”€ example.test.ts
```

**ì˜ˆì •ëœ í™•ì¥**:
```
src/shared/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ui/             # Button, Input, Modal, Card ë“±
â”œâ”€â”€ lib/                # ìœ í‹¸ í•¨ìˆ˜
â”œâ”€â”€ hooks/              # ì»¤ìŠ¤í…€ í›…
â”œâ”€â”€ types/              # ê³µí†µ íƒ€ì… ì •ì˜
â””â”€â”€ constants/          # ìƒìˆ˜ ì •ì˜
```

---

### `e2e/` â€” Playwright E2E í…ŒìŠ¤íŠ¸

Playwright ê¸°ë°˜ E2E í…ŒìŠ¤íŠ¸.

**ì˜ˆì •ëœ êµ¬ì¡°**:
```
e2e/
â”œâ”€â”€ photo-mode.spec.ts  # Photo Mode Happy Path
â”œâ”€â”€ map-mode.spec.ts    # Map Mode Happy Path
â””â”€â”€ README.md
```

---

### `mocks/` â€” MSW (Mock Service Worker)

API Mocking. ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì™¸ë¶€ API ëŒ€ì²´.

**í˜„ì¬ êµ¬ì¡°**:
```
mocks/
â”œâ”€â”€ handlers/
â”‚   â””â”€â”€ index.ts        # Azure, Nanobanana, Google, Toss Mock
â”œâ”€â”€ browser.ts          # ë¸Œë¼ìš°ì € í™˜ê²½ MSW
â”œâ”€â”€ node.ts             # Node í™˜ê²½ MSW
â””â”€â”€ README.md
```

---

## ğŸ› ï¸ Configuration Files

### `biome.json`
Biome Lint/Format ì„¤ì •. ESLint + Prettier ëŒ€ì²´.

### `vitest.config.ts`
Vitest ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ ì„¤ì •.

### `playwright.config.ts`
Playwright E2E í…ŒìŠ¤íŠ¸ ì„¤ì •.

### `lefthook.yml`
Git Hooks ì„¤ì •. pre-commit ì‹œ Biome Lint/Format ìë™ ì‹¤í–‰.

### `components.json`
Shadcn/UI ì„¤ì •. ì»´í¬ë„ŒíŠ¸ ì„¤ì¹˜ ê²½ë¡œ ë° ìŠ¤íƒ€ì¼ ì •ì˜.

### `next.config.ts`
Next.js ì„¤ì •. ì‹¤í—˜ì  ê¸°ëŠ¥, ì´ë¯¸ì§€ ìµœì í™” ë“±.

### `tsconfig.json`
TypeScript ì„¤ì •. Path Alias (`@/`) ì •ì˜.

---

## ğŸ”„ Update Protocol

ì´ ë¬¸ì„œëŠ” ë‹¤ìŒ ì‹œì ì— ì—…ë°ì´íŠ¸ëœë‹¤:

1. **ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬/íŒŒì¼ ì¶”ê°€ ì‹œ**
2. **Layer êµ¬ì¡° ë³€ê²½ ì‹œ**
3. **ì•„í‚¤í…ì²˜ íŒ¨í„´ ë³€ê²½ ì‹œ**
4. **ì£¼ìš” ê¸°ëŠ¥ ê°œë°œ ì™„ë£Œ ì‹œ**

---

## [2025-12-16] ì—…ë°ì´íŠ¸
- ì¶”ê°€: src/widgets/step-header/ â€” Step ê³µí†µ í—¤ë” ìœ„ì ¯(ë’¤ë¡œê°€ê¸° ì¡°ê±´ ë…¸ì¶œ)
- ë³€ê²½: src/pages/select-mode/ui/select-mode-page.tsx â€” StepHeaderë¡œ ê³µí†µ í—¤ë” ì¡°í•©
- ë³€ê²½: src/pages/upload-photo/ui/upload-photo-page.tsx â€” StepHeaderë¡œ ê³µí†µ í—¤ë” ì¡°í•©
- ë³€ê²½: src/features/select-mode/ui/select-mode-view.tsx â€” í—¤ë” ì˜ì—­ ì œê±°(ì½˜í…ì¸ ë§Œ ìœ ì§€)
- ë³€ê²½: src/features/upload-photo/ui/upload-photo-view.tsx â€” í—¤ë”/ë’¤ë¡œê°€ê¸° ì œê±°, ë¯¸ë¦¬ë³´ê¸° URL ì–¸ë§ˆìš´íŠ¸ ì •ë¦¬

## [2025-12-17] ì—…ë°ì´íŠ¸
- ì¶”ê°€: src/features/upload-photo/model/use-upload-dropzone.ts â€” Dropzone ë¡œì§ì„ model í›…ìœ¼ë¡œ ë¶„ë¦¬
- ì¶”ê°€: src/features/upload-photo/model/use-upload-photo-flow.ts â€” ì—…ë¡œë“œ ì„±ê³µ ì‹œ Step ì „í™˜ì„ ì™¸ë¶€ ì½œë°±ìœ¼ë¡œ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
- ë³€ê²½: src/features/upload-photo/ui/upload-dropzone.tsx â€” UI ì»´í¬ë„ŒíŠ¸ëŠ” props ê¸°ë°˜ ë Œë”ë§ë§Œ ìˆ˜í–‰
- ë³€ê²½: src/features/upload-photo/model/use-photo-upload.ts â€” ì—…ë¡œë“œ í›…ì—ì„œ Step ì „í™˜ ì œê±°(ì„±ê³µ ì½œë°± ì£¼ì…)
- ë³€ê²½: src/features/upload-photo/ui/upload-photo-view.tsx â€” `useUploadPhotoFlow`ë¡œ Step ì „í™˜ ì˜ì¡´ì„± ë¶„ë¦¬
- ë³€ê²½: src/features/upload-photo/ui/photo-preview.tsx â€” ì´ë¯¸ì§€ ë Œë”ë§ `next/image`ë¡œ ì „í™˜(í”„ë¦¬ë·°ëŠ” `unoptimized`)

## [2025-12-17] ì—…ë°ì´íŠ¸
- ì¶”ê°€: src/features/select-mode/ui/select-mode-view.test.tsx â€” SelectModeView ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/features/select-mode/ui/select-mode-view.stories.tsx â€” SelectModeView ìŠ¤í† ë¦¬
- ì¶”ê°€: src/features/upload-photo/ui/*.test.tsx â€” UPLOAD UI ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/features/upload-photo/ui/*.stories.tsx â€” UPLOAD UI ìŠ¤í† ë¦¬
- ì¶”ê°€: src/pages/select-mode/ui/*.test.tsx â€” SELECT_MODE Page ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/pages/select-mode/ui/*.stories.tsx â€” SELECT_MODE Page ìŠ¤í† ë¦¬
- ì¶”ê°€: src/pages/upload-photo/ui/*.test.tsx â€” UPLOAD Page ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/pages/upload-photo/ui/*.stories.tsx â€” UPLOAD Page ìŠ¤í† ë¦¬
- ì¶”ê°€: src/widgets/step-header/ui/step-header.stories.tsx â€” StepHeader ìŠ¤í† ë¦¬
- ì¶”ê°€: .storybook/next-image.ts â€” Storybookì—ì„œ `next/image` ëŒ€ì²´ ë Œë”ëŸ¬
- ë³€ê²½: .storybook/main.ts â€” Storybook Vite alias(`next/image`) ì„¤ì •
- ë³€ê²½: vitest.setup.ts â€” í…ŒìŠ¤íŠ¸ì—ì„œ `next/image` mock ì¶”ê°€
- ë³€ê²½: src/features/upload-photo/ui/upload-photo-view.tsx â€” í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ìš© flow ì£¼ì… ì§€ì›
- ë³€ê²½: src/pages/upload-photo/ui/upload-photo-page.tsx â€” í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ìš© flow ì£¼ì… ì§€ì›

## [2025-12-17] ì—…ë°ì´íŠ¸
- ì¶”ê°€: src/entities/photo/ â€” Step ê°„ ì„ íƒ íŒŒì¼ ìƒíƒœ ìœ ì§€ ì—”í‹°í‹°
- ì¶”ê°€: src/entities/photo/model/store.ts â€” ì„ íƒëœ `File` ì €ì¥ Store(Zustand)
- ë³€ê²½: src/features/upload-photo/model/use-upload-photo-flow.ts â€” íŒŒì¼ ì„ íƒ í›„ `entities/photo` ì €ì¥ + MATCH ì´ë™
- ë³€ê²½: src/features/upload-photo/model/use-photo-upload.ts â€” ê°€ì§œ ì—…ë¡œë“œ/ë¡œë”© ì œê±°, `onNext` ì½œë°±ìœ¼ë¡œ ë‹¨ìˆœí™”

## [2025-12-17] ì—…ë°ì´íŠ¸ - MATCH/EXPRESSION Step êµ¬í˜„
- ì¶”ê°€: src/entities/person/ â€” ì¸ë¬¼ ë§ˆì»¤ ìƒíƒœ ê´€ë¦¬ ì—”í‹°í‹°
- ì¶”ê°€: src/entities/person/model/types.ts â€” PersonColor, MarkerTransform, Person, PersonState íƒ€ì… ì •ì˜
- ì¶”ê°€: src/entities/person/model/store.ts â€” Person Store (Zustand) - ì´ˆê¸°í™”/ì¬ì´ˆê¸°í™”, ìµœëŒ€ 5ëª…, ê³ ì • ìƒ‰ìƒ ìˆœì„œ
- ì¶”ê°€: src/features/match-photo/ â€” MATCH Step UI ì»´í¬ë„ŒíŠ¸ë“¤
- ì¶”ê°€: src/features/match-photo/ui/person-marker.tsx â€” ë“œë˜ê·¸/ìŠ¤ì¼€ì¼/íšŒì „ ë§ˆì»¤
- ì¶”ê°€: src/features/match-photo/ui/person-button.tsx â€” í•˜ë‹¨ ì‚¬ëŒ ë²„íŠ¼
- ì¶”ê°€: src/features/match-photo/ui/add-person-button.tsx â€” ì‚¬ëŒ ì¶”ê°€ ë²„íŠ¼
- ì¶”ê°€: src/features/match-photo/ui/person-list-panel.tsx â€” í•˜ë‹¨ íŒ¨ë„ (ì´ˆê¸°í™” ë²„íŠ¼ í¬í•¨)
- ì¶”ê°€: src/features/match-photo/ui/image-canvas.tsx â€” ë² ì´ìŠ¤ ì´ë¯¸ì§€ + ë§ˆì»¤ ì˜¤ë²„ë ˆì´
- ì¶”ê°€: src/features/match-photo/ui/match-photo-view.tsx â€” MATCH Step ë©”ì¸ ë·°
- ì¶”ê°€: src/features/expression-select/ â€” EXPRESSION Step (placeholder)
- ì¶”ê°€: src/pages/match-photo/ â€” MATCH í˜ì´ì§€
- ì¶”ê°€: src/pages/expression-select/ â€” EXPRESSION í˜ì´ì§€
- ë³€ê²½: src/entities/step/model/step.ts â€” EXPRESSION Step ì¶”ê°€
- ë³€ê²½: src/entities/step/model/transition.ts â€” MATCH â†’ EXPRESSION â†’ PAYMENT ì „ì´ ê·œì¹™
- ë³€ê²½: src/app/router/step-router.tsx â€” MATCH, EXPRESSION í˜ì´ì§€ ë¼ìš°íŒ… ì¶”ê°€

## [2025-12-17] ì—…ë°ì´íŠ¸ - PersonMarker ê¸°ëŠ¥ ê°œì„ 
- ë³€ê²½: src/entities/person/model/types.ts â€” MarkerTransformì— imageOffsetX, imageOffsetY í•„ë“œ ì¶”ê°€
- ë³€ê²½: src/entities/person/model/store.ts â€” DEFAULT_TRANSFORMì— imageOffset ê¸°ë³¸ê°’ ì¶”ê°€
- ë³€ê²½: src/features/match-photo/ui/person-marker.tsx â€” íšŒì „ ê¸°ëŠ¥ ê°œì„  (íšŒì „ wrapper ë¶„ë¦¬), ì´ë¯¸ì§€ ì˜¤í”„ì…‹ í•¸ë“¤ ì¶”ê°€
- ë³€ê²½: src/features/match-photo/ui/person-button.tsx â€” layout ì• ë‹ˆë©”ì´ì…˜ ì œê±° (ë²„ë²…ì„ í•´ê²°)
- ë³€ê²½: src/features/match-photo/ui/person-list-panel.tsx â€” AnimatePresence modeë¥¼ syncë¡œ ë³€ê²½
- ë³€ê²½: src/features/match-photo/ui/image-canvas.tsx â€” onImageOffsetChange prop ì¶”ê°€
- ë³€ê²½: src/features/match-photo/ui/match-photo-view.tsx â€” ì´ë¯¸ì§€ ì˜¤í”„ì…‹ í•¸ë“¤ëŸ¬ ì¶”ê°€

## [2025-12-17] ì—…ë°ì´íŠ¸ - MATCH/EXPRESSION í…ŒìŠ¤íŠ¸Â·ìŠ¤í† ë¦¬ ë³´ê°•
- ì¶”ê°€: src/features/match-photo/ui/*.test.tsx â€” MATCH UI ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/features/match-photo/ui/*.stories.tsx â€” MATCH UI ìŠ¤í† ë¦¬
- ì¶”ê°€: src/pages/match-photo/ui/*.test.tsx â€” MATCH Page ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/pages/match-photo/ui/*.stories.tsx â€” MATCH Page ìŠ¤í† ë¦¬
- ì¶”ê°€: src/features/expression-select/ui/*.test.tsx â€” EXPRESSION UI ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/features/expression-select/ui/*.stories.tsx â€” EXPRESSION UI ìŠ¤í† ë¦¬
- ì¶”ê°€: src/pages/expression-select/ui/*.test.tsx â€” EXPRESSION Page ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/pages/expression-select/ui/*.stories.tsx â€” EXPRESSION Page ìŠ¤í† ë¦¬
- ì¶”ê°€: src/entities/person/model/store.test.ts â€” Person Store ìœ ë‹› í…ŒìŠ¤íŠ¸
- ì¶”ê°€: src/entities/person/model/export-for-ai.test.ts â€” MATCH ë°ì´í„° ë‚´ë³´ë‚´ê¸° ìœ í‹¸ ìœ ë‹› í…ŒìŠ¤íŠ¸
- ë³€ê²½: src/features/match-photo/ui/person-button.tsx â€” ì¤‘ì²© button ì œê±°(í•˜ì´ë“œë ˆì´ì…˜ ì˜¤ë¥˜ ë°©ì§€)
- ë³€ê²½: vitest.setup.ts â€” next/image mock ê°œì„  + pointer capture polyfill

## [2025-12-17] ì—…ë°ì´íŠ¸ - Biome lint ì •ë¦¬ ë° ê²€ì‚¬ ê·œì¹™
- ë³€ê²½: src/entities/person/index.ts â€” Public APIë¥¼ named exportë¡œ ë³€ê²½(noReExportAll ëŒ€ì‘)
- ë³€ê²½: src/entities/person/model/index.ts â€” model Public APIë¥¼ named exportë¡œ ë³€ê²½(noReExportAll ëŒ€ì‘)
- ë³€ê²½: src/entities/person/model/store.ts â€” ì•¡ì…˜ ë¶„ë¦¬/íƒ€ì… ì •ë¦¬ë¡œ Biome lint ëŒ€ì‘
- ë³€ê²½: src/features/match-photo/ui/person-marker.tsx â€” ë¡œì§ ë¶„ë¦¬ + `next/image`ë¡œ ì „í™˜(noImgElement/noExcessiveLines ëŒ€ì‘)
- ë³€ê²½: src/features/match-photo/ui/person-list-panel.tsx â€” ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ë¶„ë¦¬(useSolidForComponent ê²½ê³  ëŒ€ì‘)
- ë³€ê²½: src/features/match-photo/ui/image-canvas.tsx â€” ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ë¶„ë¦¬(useSolidForComponent ê²½ê³  ëŒ€ì‘)
- ë³€ê²½: src/features/expression-select/ui/expression-select-view.tsx â€” `next/image`ë¡œ ì „í™˜ + ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ì •ë¦¬
- ë³€ê²½: .ruler/AGENTS.md â€” ì½”ë“œ ë³€ê²½ ì‹œ `pnpm check`ë¥¼ í†µê³¼í•  ë•Œê¹Œì§€ ë³´ì™„ ê·œì¹™ ì¶”ê°€
- ë³€ê²½: src/features/match-photo/ui/person-button.tsx â€” ì¹´ë“œ ì˜ì—­ í´ë¦­ìœ¼ë¡œ Active ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ UX ë³µì›(ì¤‘ì²© button ì—†ì´ ì²˜ë¦¬)
- ë³€ê²½: src/features/match-photo/ui/person-list-panel.tsx â€” ì—…ë¡œë“œ í´ë¦­ ì‹œ ëŒ€ìƒ ì¸ë¬¼ì„ Activeë¡œ ìë™ ì„ íƒ


## ğŸ“Œ Key Principles

### 1. Single Responsibility
ê° LayerëŠ” ëª…í™•í•œ ì±…ì„ì„ ê°€ì§„ë‹¤.

- **app**: ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”, ì „ì—­ í”„ë¡œë°”ì´ë”, ë¼ìš°íŒ…
- **pages**: í˜ì´ì§€ ë‹¨ìœ„ ì¡°í•© (features + entities + widgets)
- **widgets**: ë³µí•© UI ë¸”ë¡ (ì—¬ëŸ¬ features/entities ì¡°í•©)
- **features**: ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ (ì“°ê¸° ì‘ì—… + ì‚¬ìš©ì ì˜ë„)
- **entities**: ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° (ì½ê¸° ì „ìš© + ìˆœìˆ˜ UI)
- **shared**: ê³µí†µ ì½”ë“œ (UI ì»´í¬ë„ŒíŠ¸, ìœ í‹¸, í›…, ìƒìˆ˜)

### 2. Unidirectional Dependency
ìƒìœ„ â†’ í•˜ìœ„ ë°©í–¥ìœ¼ë¡œë§Œ ì˜ì¡´ì„± íë¦„.

```
app â†’ pages â†’ widgets â†’ features â†’ entities â†’ shared
```

### 3. Isolation
ê°™ì€ Layer ê°„ ì°¸ì¡° ê¸ˆì§€.

**ê¸ˆì§€ ì˜ˆì‹œ**:
```typescript
// âŒ features/A â†’ features/B (ê°™ì€ Layer ì°¸ì¡° ê¸ˆì§€)
// âŒ pages/A â†’ pages/B (ê°™ì€ Layer ì°¸ì¡° ê¸ˆì§€)

// âœ… features/A â†’ entities/B (í•˜ìœ„ Layer ì°¸ì¡° í—ˆìš©)
// âœ… pages/A â†’ features/B (í•˜ìœ„ Layer ì°¸ì¡° í—ˆìš©)
```

### 4. Scalability
ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ìµœì†Œí™”.

### 5. Testability
ê° LayerëŠ” ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥.

### 6. FSD êµ¬ì¡° ê·œì¹™ ì¤€ìˆ˜

**ì¼ë°˜ Layer** (pages, widgets, features, entities):
```
Layer â†’ Slice â†’ Segment
```

**íŠ¹ìˆ˜ Layer** (app, shared):
```
Layer â†’ Segment (Slice ì—†ìŒ!)
```

---

## ğŸ“š References

- [FSD Documentation](https://feature-sliced.design)
- [Next.js App Router](https://nextjs.org/docs/app)
- [Vitest](https://vitest.dev)
- [Playwright](https://playwright.dev)
- [MSW](https://mswjs.io)



<!-- Source: .ruler/PlAN.md -->

# LateProof â€” Implementation Plan

> **ëª©ì **: AIê°€ ìŠ¤ìŠ¤ë¡œ ì§„í–‰ìƒí™©ì„ íŒŒì•…í•˜ê³  ë‹¤ìŒ ì‘ì—…ì„ ê²°ì •í•˜ê¸° ìœ„í•œ Task ê´€ë¦¬ ë„êµ¬  
> **ê°±ì‹  ë°©ì‹**: ì‘ì—… ì™„ë£Œ ì‹œë§ˆë‹¤ ì´ ë¬¸ì„œë¥¼ ì—…ë°ì´íŠ¸  
> **Last Updated**: 2025-12-18 (TypeScript íƒ€ì… ì—ëŸ¬ ìˆ˜ì • + `pnpm tsc` íƒ€ì… ê²€ì‚¬ ê·œì¹™ ì¶”ê°€)

---

## ğŸ“Š Current Status

**í˜„ì¬ Phase**: `M2 â€” Photo Mode Core Flow`  
**ì „ì²´ ì§„í–‰ë¥ **: `26.7%` (43/161 tasks)  
**í˜„ì¬ ì‘ì—… ì¤‘**: M2-E5-T04 (í‘œì • ë°ì´í„° AI ì „ë‹¬ìš© í¬ë§·)  
**ì°¨ë‹¨ ìš”ì†Œ**: ì—†ìŒ

---

## ğŸ¯ Current Focus

### ì§€ê¸ˆ ì‘ì—… ì¤‘ì¸ Task

- [x] M2-E4-T01: Person ë§ˆì»¤ ì‹œìŠ¤í…œ êµ¬í˜„ âœ… ì™„ë£Œ
- [x] M2-E4-T02: ë§ˆì»¤ ìŠ¤ì¼€ì¼/íšŒì „ í•¸ë“¤ êµ¬í˜„ âœ… ì™„ë£Œ
- [x] M2-E4-T03: ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ë° ì´ë¯¸ì§€ ì˜¤í”„ì…‹/í¬ê¸° ì¡°ì • âœ… ì™„ë£Œ
- [x] M2-E4-T04: ì¸ë¬¼ ì„¤ì • íŒ¨ë„ UI âœ… ì™„ë£Œ
- [x] M2-E4-T05: ë’¤ë¡œê°€ê¸° ì‹œ Person ìƒíƒœ ì´ˆê¸°í™” âœ… ì™„ë£Œ
- [x] M2-E4-T06: AI ì´ë¯¸ì§€ ìƒì„±ìš© ë°ì´í„° ë‚´ë³´ë‚´ê¸° ìœ í‹¸ë¦¬í‹° âœ… ì™„ë£Œ
- [x] M2-E5-T01: EXPRESSION Step FSM ì „ì´ ê·œì¹™ âœ… ì™„ë£Œ
- [x] M2-E5-T02: ExpressionSelectView í”Œë ˆì´ìŠ¤í™€ë” âœ… ì™„ë£Œ

**ğŸ‰ Epic 2.4 â€” MATCH Step êµ¬í˜„ + í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ì™„ë£Œ!**

### ë‹¤ìŒ ì‘ì—… (ìš°ì„ ìˆœìœ„ ìˆœ)

1. **M2-E5-T04**: í‘œì • ë°ì´í„° ì €ì¥ ë° AI ì „ë‹¬ìš© í¬ë§·
2. **M2-E7-T01**: Toss Payments SDK ì—°ë™

---

## âœ… Completed Tasks

### Milestone 1 â€” Foundation Setup

#### Epic 1.1 â€” Repository & Environment âœ… ì™„ë£Œ
- [x] M1-E1-T01: GitHub Repository ìƒì„± (git repo í™•ì¸)
- [x] M1-E1-T02: README ì´ˆê¸° í…œí”Œë¦¿ ì‘ì„± (README.md ì¡´ì¬)
- [x] M1-E1-T03: Biome ì´ˆê¸° ì„¤ì • (biome.json ì™„ì „ ì„¤ì • ì™„ë£Œ)
- [x] M1-E1-T03-1: Lefthook Git Hooks ì„¤ì • (lefthook.yml ìƒì„±, package.json ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€)
- [x] M1-E1-T04: Vercel í”„ë¡œì íŠ¸ ìƒì„± (ì‚¬ìš©ì í™•ì¸ ì™„ë£Œ)
- [x] M1-E1-T05: í™˜ê²½ ë³€ìˆ˜ êµ¬ì¡° ì„¤ê³„ (.env.example ìƒì„± ì™„ë£Œ)

#### Epic 1.2 â€” Next.js + FSD êµ¬ì¡°
- [x] M1-E2-T01: Next.js App Router ì´ˆê¸°í™” (app/layout.tsx, page.tsx ì¡´ì¬)
- [x] M1-E2-T02: src/ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± (src/ ì™„ë£Œ)
- [x] M1-E2-T03: FSD Layer êµ¬ì¶• (app/features/entities/shared/widgets ëª¨ë‘ ì¡´ì¬)

#### Epic 1.3 â€” UI Design System & Storybook âœ… ì™„ë£Œ
- [x] M1-E3-T01: TailwindCSS ì„¤ì¹˜ (tailwindcss v4, globals.css í™•ì¸)
- [x] M1-E3-T02: Shadcn ì´ˆê¸°í™” (components.json, @radix-ui/react-slot í™•ì¸)
- [x] M1-E3-T03: ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸ ì‘ì„± â€” Buttonë§Œ ì™„ë£Œ (shared/components/ui/button.tsx)
- [x] M1-E3-T04: SG.md ê¸°ë°˜ ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ êµ¬ì¶• (ì™„ë£Œ)
- [x] M1-E3-T05: Storybook ì„¤ì¹˜ (ì™„ë£Œ â€” v10.1.5, nextjs-vite)

#### Epic 1.4 â€” Testing Environment Setup âœ… ì™„ë£Œ
- [x] M1-E4-T01: Vitest ì„¤ì¹˜ ë° ì„¤ì • (vitest.config.ts, vitest.setup.ts ìƒì„±)
- [x] M1-E4-T02: Testing Library ì„¤ì¹˜ ë° setup (@testing-library/react, jest-dom, user-event)
- [x] M1-E4-T03: MSW ì„¤ì¹˜ ë° í•¸ë“¤ëŸ¬ êµ¬ì¡° ìƒì„± (src/mocks ì™„ë£Œ)
- [x] M1-E4-T04: Playwright ì„¤ì¹˜ ë° ì„¤ì • (playwright.config.ts, e2e/ ì™„ë£Œ)
- [x] M1-E4-T05: package.json í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ ë° Lefthook í†µí•©
- [x] M1-E4-T06: ê¸°ëŠ¥ ì¶”ê°€/ìˆ˜ì • í›„ TypeScript íƒ€ì… ê²€ì‚¬(`pnpm tsc`) ìˆ˜í–‰ ê·œì¹™ ë¬¸ì„œí™”

### Milestone 2 â€” Photo Mode Core Flow

#### Epic 2.1 â€” FSM êµ¬ì¶• âœ… ì™„ë£Œ
- [x] M2-E1-T01: Step Enum ì •ì˜ (src/entities/step/model/step.ts)
- [x] M2-E1-T02: Transition Table ì •ì˜ (src/entities/step/model/transition.ts)
- [x] M2-E1-T03: Zustand FSM Store êµ¬ì¶• (src/entities/step/model/store.ts + store.test.ts)

#### Epic 2.2 â€” SELECT_MODE Step âœ… ì™„ë£Œ
- [x] M2-E2-T01: Photo/Map ì„ íƒ UI + UI í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ (src/features/select-mode/ui/mode-card.tsx, src/features/select-mode/ui/select-mode-view.tsx)
- [x] M2-E2-T02: Step ì´ë™ ì²˜ë¦¬ + Page í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ (src/pages/select-mode/ui/select-mode-page.tsx)
- [x] M2-E2-T03: í˜ì´ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ + Step ê³µí†µ ë ˆì´ì•„ì›ƒ(ë„ˆë¹„/í—¤ë”) + StepHeader ìŠ¤í† ë¦¬ (src/app/router/step-router.tsx, src/widgets/step-header/ui/step-header.tsx)

#### Epic 2.3 â€” UPLOAD Step âœ… ì™„ë£Œ
- [x] M2-E3-T01: ì´ë¯¸ì§€ ì—…ë¡œë“œ(íŒŒì¼ ì„ íƒ) + íŒŒì¼ ìƒíƒœ ì €ì¥(entities/photo) + MATCH ì´ë™ (src/entities/photo/model/store.ts, src/features/upload-photo/model/use-upload-photo-flow.ts)

#### Epic 2.4 â€” MATCH Step âœ… ì™„ë£Œ (7/7 tasks)
- [x] M2-E4-T01: Person ë§ˆì»¤ ì‹œìŠ¤í…œ êµ¬í˜„ + ì¸ë¬¼ ì¶”ê°€ ì‹œ ê¸°ë³¸ ìŠ¤íƒ ë°°ì¹˜ (src/entities/person/model/store.ts, src/features/match-photo/ui/person-marker.tsx)
- [x] M2-E4-T02: ë§ˆì»¤ ìŠ¤ì¼€ì¼/íšŒì „ í•¸ë“¤ êµ¬í˜„ (Active ìƒíƒœì—ì„œë§Œ í‘œì‹œ)
- [x] M2-E4-T03: ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ë° ì´ë¯¸ì§€ ì˜¤í”„ì…‹/í¬ê¸° ì¡°ì • ê¸°ëŠ¥
- [x] M2-E4-T04: ì¸ë¬¼ ì„¤ì • íŒ¨ë„ UI (src/features/match-photo/ui/person-list-panel.tsx)
- [x] M2-E4-T05: ë’¤ë¡œê°€ê¸° ì‹œ Person ìƒíƒœ ì´ˆê¸°í™” (StepHeader onBeforeBack prop)
- [x] M2-E4-T06: AI ì´ë¯¸ì§€ ìƒì„±ìš© ë°ì´í„° ë‚´ë³´ë‚´ê¸° ìœ í‹¸ë¦¬í‹° (src/entities/person/model/export-for-ai.ts)
- [x] M2-E4-T07: MATCH Step ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ì‘ì„±

#### Epic 2.5 â€” EXPRESSION Step ğŸš§ ì§„í–‰ ì¤‘ (3/4 tasks)
- [x] M2-E5-T01: EXPRESSION Step FSM ì „ì´ ê·œì¹™ ì¶”ê°€
- [x] M2-E5-T02: ExpressionSelectView í”Œë ˆì´ìŠ¤í™€ë” UI (src/features/expression-select/ui/expression-select-view.tsx)
- [x] M2-E5-T03: ì¸ë¬¼ë³„ í‘œì • ì„ íƒ UI êµ¬í˜„ (emoji-picker-react ì‚¬ìš©)
- [ ] M2-E5-T04: í‘œì • ë°ì´í„° ì €ì¥ ë° AI ì „ë‹¬ìš© í¬ë§·

#### Epic 2.6 â€” ì–¼êµ´ ê²€ì¦ (MATCH Step í†µí•©) âœ… ì™„ë£Œ (4/4 tasks)
- [x] M2-E6-T01: Azure Face API Wrapper ì‘ì„± (app/api/face/validate/route.ts)
- [x] M2-E6-T02: MATCH Stepì—ì„œ ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ì‹œ Azure Face ê²€ì¦ í†µí•© (src/features/match-photo/ui/match-photo-view.tsx)
- [x] M2-E6-T03: ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì í”¼ë“œë°± UI (Shadcn/Sonner toastë¡œ í‘œì‹œ)
- [x] M2-E6-T04: ê²€ì¦ í†µê³¼ ì‹œ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰ í—ˆìš© (ê²€ì¦ ì„±ê³µ ì‹œì—ë§Œ facePhoto ì„¤ì •)

### í†µê³„
- **ì™„ë£Œ**: 43 tasks
- **ì§„í–‰ ì¤‘**: 1 tasks
- **ë‚¨ì€ ì‘ì—…**: 117 tasks

### Epic ì™„ë£Œ í˜„í™©
- **M1-E1**: âœ… 100% (6/6 tasks) â€” Repository & Environment ì™„ë£Œ
- **M1-E2**: âœ… 100% (3/3 tasks) â€” Next.js + FSD êµ¬ì¡° ì™„ë£Œ
- **M1-E3**: âœ… 100% (5/5 tasks) â€” UI Design System & Storybook ì™„ë£Œ
- **M1-E4**: âœ… 100% (5/5 tasks) â€” Testing Environment Setup ì™„ë£Œ
- **M2-E1**: âœ… 100% (3/3 tasks) â€” FSM êµ¬ì¶• ì™„ë£Œ
- **M2-E2**: âœ… 100% (3/3 tasks) â€” SELECT_MODE Step ì™„ë£Œ
- **M2-E3**: âœ… 100% (1/1 tasks) â€” UPLOAD Step ì™„ë£Œ
- **M2-E4**: âœ… 100% (7/7 tasks) â€” MATCH Step ì™„ë£Œ
- **M2-E5**: ğŸš§ 75% (3/4 tasks) â€” EXPRESSION Step ì§„í–‰ ì¤‘
- **M2-E6**: âœ… 100% (4/4 tasks) â€” ì–¼êµ´ ê²€ì¦ ì™„ë£Œ


---

## ğŸš§ Blocked Tasks

í˜„ì¬ ì°¨ë‹¨ëœ ì‘ì—… ì—†ìŒ.

---

## ğŸ“ Implementation Notes

### Phaseë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### Phase 1: Foundation (M1) â€” âœ… ì™„ë£Œ (100%)
- [x] Next.js í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
- [x] FSD êµ¬ì¡° ì™„ì„±
- [x] Biome ì„¤ì •
- [x] í™˜ê²½ ë³€ìˆ˜ êµ¬ì¡° ì„¤ê³„ (.env.example)
- [x] Vercel ë°°í¬ ì„¤ì •
- [x] SG.md ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ
- [x] Storybook ì„¤ì¹˜ (v10.1.5, nextjs-vite)
- [x] Testing Environment ì„¤ì • (Vitest, Testing Library, MSW, Playwright)
- [x] ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸ â€” Button ì™„ë£Œ ë° í…ŒìŠ¤íŠ¸ ì‘ì„±

#### Phase 2: Photo Mode (M2) â€” ğŸš§ ì§„í–‰ ì¤‘ (7/27 tasks, 25.9%)
- [x] Step Enum ì •ì˜ (as const íŒ¨í„´)
- [x] Transition Table ì •ì˜ (FSM ê·œì¹™)
- [x] Zustand FSM Store êµ¬ì¶• (14 tests í†µê³¼)
- [x] SELECT_MODE Step UI êµ¬í˜„ (ModeCard, SelectModeView)
- [x] StepRouter êµ¬í˜„ (Framer Motion í˜ì´ì§€ ì „í™˜)
- [x] Framer Motion ì„¤ì¹˜ ë° ì• ë‹ˆë©”ì´ì…˜ ì ìš©
- [x] UPLOAD Step êµ¬í˜„
- [x] Azure Face API ì—°ë™
- [ ] Toss Payments ì—°ë™
- [ ] Nanobanana API ì—°ë™

#### Phase 3: Map Mode (M3) â€” ëŒ€ê¸°
- [ ] Google Maps SDK ì—°ë™
- [ ] ì¥ì†Œ ê²€ìƒ‰ UI
- [ ] Prompt Builder

#### Phase 4: AI Generation (M4) â€” ëŒ€ê¸°
- [ ] ì´ë¯¸ì§€ ìƒì„± ë¡œì§
- [ ] ë©”ëª¨ë¦¬ ê´€ë¦¬

#### Phase 5: Testing (M5) â€” ëŒ€ê¸°
- [ ] Unit Test
- [ ] Integration Test
- [ ] E2E Test

#### Phase 6: Deployment (M6) â€” ëŒ€ê¸°
- [ ] QA
- [ ] Sentry
- [ ] Vercel ë°°í¬

---

## ğŸ” Context for AI

### í”„ë¡œì íŠ¸ êµ¬ì¡° í˜„í™©

```
/app                     âœ… ì¡´ì¬ (layout.tsx, page.tsx, globals.css)
/src/app                 âœ… ì¡´ì¬ (README.md)
/src/entities            âœ… ì¡´ì¬ (README.md)
  â””â”€â”€ /step              âœ… ìƒì„± ì™„ë£Œ (Step Entity â€” FSM ì™„ì „ êµ¬í˜„)
      â””â”€â”€ /model         âœ… step.ts, transition.ts, types.ts, store.ts, store.test.ts (14 tests)
/src/features            âœ… ì¡´ì¬ (README.md)
/src/pages               âœ… ì¡´ì¬ (README.md)
/src/shared              âœ… ì¡´ì¬ (components/ui, lib)
/src/widgets             âœ… ì¡´ì¬ (README.md)
```

### ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ (package.json ê¸°ì¤€)

```json
{
  "next": "^15.1.2",
  "react": "^19.0.0",
  "react-dom": "^19.0.0",
  "tailwindcss": "^3.4.17",
  "@biomejs/biome": "^1.9.4"
}
```

### ì„¤ì¹˜ëœ í•„ìˆ˜ íŒ¨í‚¤ì§€

- [x] `zustand` â€” FSM ìƒíƒœ ê´€ë¦¬
- [x] `framer-motion` â€” ì• ë‹ˆë©”ì´ì…˜
- [x] `@radix-ui/*` â€” Shadcn ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸
- [x] `vitest` â€” í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
- [x] `@testing-library/react` â€” ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
- [x] `msw` â€” API Mocking
- [x] `@playwright/test` â€” E2E í…ŒìŠ¤íŠ¸
- [x] `@storybook/nextjs-vite` â€” UI ì¹´íƒˆë¡œê·¸

### ì•„ì§ ì„¤ì¹˜ë˜ì§€ ì•Šì€ í•„ìˆ˜ íŒ¨í‚¤ì§€

- [ ] `@tanstack/react-query` â€” ì„œë²„ ìƒíƒœ ê´€ë¦¬
- [ ] `react-dropzone` â€” íŒŒì¼ ì—…ë¡œë“œ
- [ ] `@googlemaps/js-api-loader` â€” Google Maps
- [ ] `@azure/cognitiveservices-face` â€” Azure Face API
- [ ] `@toss/payments` â€” Toss Payments

---

## ğŸ¬ Next Actions

### ì¦‰ì‹œ ìˆ˜í–‰ ê°€ëŠ¥í•œ ì‘ì—…

1. **Biome ì„¤ì • ì™„ì„±**
   - `biome.json` ê²€ì¦
   - Lint/Format ê·œì¹™ ì„¤ì •

2. **FSD êµ¬ì¡° ì™„ì„±**
   - ê° Layerë³„ index.ts ìƒì„±
   - íƒ€ì… ì •ì˜ êµ¬ì¡° ì„¤ê³„

3. **í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜**
   - Zustand, React Query, Framer Motion

4. **Storybook ì´ˆê¸° ì„¤ì •**
   - ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
   - Button ì»´í¬ë„ŒíŠ¸ Story ì‘ì„±

### ì¤€ë¹„ í•„ìš”í•œ ì‘ì—… (í™˜ê²½ë³€ìˆ˜/ì¸ì¦)

- Azure Face API í‚¤
- Google Maps API í‚¤
- Nanobanana API í‚¤
- Toss Payments í‚¤

---

## ğŸ“Œ Quick Reference

### PRD í•µì‹¬ ìš”ì•½
- **Flow**: SELECT_MODE â†’ UPLOAD â†’ MATCH â†’ PAYMENT â†’ GENERATE â†’ RESULT
- **AI**: Nanobanana (ìƒì„±), Azure (ê²€ì¦)
- **ê²°ì œ**: Toss Payments (300~500ì›)
- **ì•„í‚¤í…ì²˜**: FSD (features/entities/shared)
- **ìƒíƒœê´€ë¦¬**: Zustand FSM

### ê¸°ìˆ  ìŠ¤íƒ
- Next.js App Router
- React 18
- TailwindCSS + Shadcn/UI
- Framer Motion
- React Query + Zustand
- Vitest + Playwright + Storybook
- Biome

### í…ŒìŠ¤íŠ¸ ì „ëµ
- Unit: FSM, ì–¼êµ´ ê²€ì¦, Payload builder (50%+)
- Integration: ì—…ë¡œë“œâ†’ê²€ì¦â†’ê²°ì œâ†’ìƒì„± (MSW)
- E2E: Photo/Map Mode Happy Path (Playwright)

---
## ğŸ”„ Update Protocol

ì´ ë¬¸ì„œëŠ” ë‹¤ìŒ ì‹œì ì— ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤:

1. Task ì™„ë£Œ ì‹œ
2. ìƒˆë¡œìš´ Phase ì‹œì‘ ì‹œ
3. ì°¨ë‹¨ ìš”ì†Œ ë°œìƒ ì‹œ
4. ì¤‘ìš” ê²°ì • ì‚¬í•­ ë°œìƒ ì‹œ



<!-- Source: .ruler/PRD.md -->

# ğŸ“ **LateProof â€” Product Requirements Document (PRD) v1.2**

---

# 1. ê°œìš”

## 1.1 ì œí’ˆëª…

**LateProof**

## 1.2 ëª©ì 

ë¶€ëª¨ë‹˜, ì—°ì¸, ì¹œêµ¬ì—ê²Œ í•„ìš”í•œ ìˆœê°„ì— ìì—°ìŠ¤ëŸ½ê³  ì§„ì§œì²˜ëŸ¼ ë³´ì´ëŠ” â€œì¦‰ì„ ì¸ì¦ìƒ· ì´ë¯¸ì§€â€ë¥¼ ìƒì„±í•´ì£¼ëŠ” ì„œë¹„ìŠ¤.
ì‚¬ì§„ ê¸°ë°˜ ë˜ëŠ” ì§€ë„ ê¸°ë°˜ìœ¼ë¡œ í˜„ì‹¤ê° ìˆëŠ” ì¸ì¦ìƒ·ì„ 3ì¥ ìƒì„±í•˜ì—¬ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥.

## 1.3 í•µì‹¬ ê°€ì¹˜

* ë‚œê°í•œ ìˆœê°„ì„ **ì¦‰ì‹œ í•´ê²°** (ì¦‰ì„ ì¸ì¦)
* ì§„ì§œ ê°™ì€ â€œì•„ì´í° ì´¬ì˜ í†¤â€ì˜ ì´ë¯¸ì§€ ìƒì„±
* ì›ë³¸ ë°°ê²½ 100% ìœ ì§€
* ê²ŒìŠ¤íŠ¸ ê¸°ë°˜ 1íšŒì„± íˆ´
* ë°ì´í„°ëŠ” ë©”ëª¨ë¦¬ ì²˜ë¦¬ í›„ ì¦‰ì‹œ ì‚­ì œ
* ì €ë ´í•œ ë‹¨ì¼ ê³¼ê¸ˆ(300~500ì›)

---

# 2. íƒ€ê¹ƒ ì‚¬ìš©ì

| ì‚¬ìš©ì ê·¸ë£¹        | ë‹ˆì¦ˆ                   |
| ------------- | -------------------- |
| 10~30ëŒ€        | ë¶€ëª¨ë‹˜/ì—°ì¸ì—ê²Œ ì¸ì¦ ìš”ì²­ ë°›ëŠ” ìƒí™© |
| ì¦‰í¥ì  ì•½ì† ì‚¬ìš©ì    | ì‚¬ì§„ì„ ë°”ë¡œ ì°ê¸° ì–´ë ¤ìš´ ìƒí™© í•´ê²°  |
| SNSÂ·ì¼ìƒ ì¸ì¦ ì‚¬ìš©ì | ìì—°ìŠ¤ëŸ¬ìš´ í•©ì„± ì¸ì¦ìƒ· í•„ìš”      |

---

# 3. í•µì‹¬ ê¸°ëŠ¥ ìš”ì•½

1. ëª¨ë“œ ì„ íƒ (ì‚¬ì§„ ê¸°ë°˜ / ì§€ë„ ê¸°ë°˜)
2. ì‚¬ì§„ ì—…ë¡œë“œ ë˜ëŠ” ì¥ì†Œ ì„ íƒ
3. ìµœëŒ€ 5ëª… ì› ë§¤ì¹­ + í‘œì • ì„ íƒ
4. ì–¼êµ´ í’ˆì§ˆ ê²€ì¦ (Azure)
5. ê²°ì œ (Toss Payments)
6. 3ì¥ ì´ë¯¸ì§€ ìƒì„± (Nanobanana)
7. ì‹¤íŒ¨í•œ 1ì¥ë§Œ ì¬ìƒì„± ê°€ëŠ¥
8. ë‹¤ìš´ë¡œë“œ

---

# 4. ì‚¬ìš©ì íë¦„ (Flow)

```
SELECT_MODE â†’ UPLOAD â†’ MATCH â†’ EXPRESSION â†’ PAYMENT â†’ GENERATE â†’ RESULT
```

### Step ì„¤ëª…

| Step | ì„¤ëª… |
|------|------|
| SELECT_MODE | ì‚¬ì§„ ê¸°ë°˜ / ì§€ë„ ê¸°ë°˜ ëª¨ë“œ ì„ íƒ |
| UPLOAD | ë² ì´ìŠ¤ ì´ë¯¸ì§€(ë°°ê²½) ì—…ë¡œë“œ |
| MATCH | ì¸ë¬¼ ë§ˆì»¤ ë°°ì¹˜ (ìµœëŒ€ 5ëª…), ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ, ìœ„ì¹˜/í¬ê¸°/íšŒì „/ì–¼êµ´ ìœ„ì¹˜ ì¡°ì • |
| EXPRESSION | ê° ì¸ë¬¼ë³„ í‘œì • ì„ íƒ (ì´ëª¨ì§€ ê¸°ë°˜) |
| PAYMENT | ê²°ì œ ì§„í–‰ (Toss Payments) |
| GENERATE | AI ì´ë¯¸ì§€ ìƒì„± (3ì¥) |
| RESULT | ê²°ê³¼ í™•ì¸ ë° ë‹¤ìš´ë¡œë“œ |

ëª¨ë“  Step ì „í™˜ì€ FSM(State Machine) ê·œì¹™ì— ë”°ë¼ í†µì œí•œë‹¤.

---

# 5. AI ì´ë¯¸ì§€ ìƒì„± ì •ì±…

## 5.1 ë°°ê²½ ì²˜ë¦¬

* ì›ë³¸ ì‚¬ì§„ ë°°ê²½ **100% ìœ ì§€**
* AIëŠ” ì¸ë¬¼ë§Œ ìƒì„±/ë³´ì •
* ì¡°ëª…Â·í¬ê¸°Â·ìœ„ì¹˜ëŠ” AI ìë™ ì¡°ì ˆ

## 5.2 ì¸ë¬¼ ì²˜ë¦¬

* ì–¼êµ´ì€ ì›ë³¸ ì´ë¯¸ì§€ì™€ ìµœëŒ€í•œ ìœ ì‚¬
* í‘œì •ì€ ì‚¬ìš©ìê°€ ì„ íƒí•œ ì´ëª¨ì§€ ê¸°ë°˜
* í”¼ë¶€í†¤ / ê´‘ì› ìì—°ê° ìš°ì„ 
* ìµœëŒ€ 5ëª…ê¹Œì§€ ìƒì„± ê°€ëŠ¥

## 5.3 ì§€ë„ ê¸°ë°˜ ì²˜ë¦¬

* ìœ„ë„/ê²½ë„ ê¸°ë°˜
* Google Placesì˜ ì§€ì—­ ë¶„ìœ„ê¸°ë¥¼ ë°˜ì˜
* â€œì‹¤ì œ ì¥ì†Œì™€ ë¹„ìŠ·í•œ ì´ë¯¸ì§€â€ ìƒì„± (ë™ì¼ ì¥ì†ŒëŠ” ì•„ë‹˜)

---

# 6. Step ê´€ë¦¬ ë°©ì‹

* Zustand ê¸°ë°˜ ì „ì—­ ìƒíƒœ
* Transition Table ê¸°ë°˜ FSM
* ì˜ëª»ëœ Step ì „í™˜ ì‹œ ì°¨ë‹¨
* ì„œë²„ ì•¡ì…˜ ì„±ê³µ ì‹œì—ë§Œ ë‹¤ìŒ Step ì´ë™
* Step ë‹¨ìœ„ UI ì „í™˜ì€ Framer Motion ì ìš©

---

# 7. ê¸°ìˆ  ìŠ¤íƒ

## 7.1 Frontend

* Next.js (App Router)
* React 18
* TailwindCSS
* Shadcn/UI
* Framer Motion
* React Query
* Zustand(FSM)
* Storybook (UI ì¹´íƒˆë¡œê·¸)

## 7.2 Backend

* Next.js Server Actions
* Vercel Edge Functions

## 7.3 AI

* Nanobanana API (ì´ë¯¸ì§€ ìƒì„±)
* Azure Face API (í’ˆì§ˆ ê²€ì¦)

## 7.4 ì§€ë„

* Google Maps JS SDK
* Google Places API
* Reverse Geocoding

## 7.5 í…ŒìŠ¤íŠ¸

* Vitest
* React Testing Library
* MSW(Mock Service Worker)
* Playwright(E2E)

## 7.6 Dev Tools

* Biome
* TypeScript
* Sentry

## 7.7 ê²°ì œ

* Toss Payments

---

# 8. ì•„í‚¤í…ì²˜ (FSD)

```
app/
features/
entities/
shared/
(FSD â€” processes ì œê±°)
```

* features = Write operations (POST/PUT/DELETE + Server Actions + ì˜ë„)
* entities = Read operations (GET + pure UI view)
* shared = lib/ui/hooks/utils/constants

---

# 9. ë³´ì•ˆ & ì •ì±…

* ë¹„ë¡œê·¸ì¸ ê²ŒìŠ¤íŠ¸ ê¸°ë°˜
* ì—…ë¡œë“œ ì´ë¯¸ì§€ëŠ” ë©”ëª¨ë¦¬ì—ë§Œ ì¡´ì¬ í›„ ì¦‰ì‹œ ì‚­ì œ
* ë°ì´í„° ì €ì¥ ì—†ìŒ
* ì™¸ë¶€ AI ìš”ì²­ë§Œ ì¡´ì¬
* ê²°ì œ ì™¸ ê°œì¸ì •ë³´ ì—†ìŒ

---

# 10. ë¹„ìš© êµ¬ì¡°

* Nanobanana API í˜¸ì¶œ íšŸìˆ˜
* Azure Face API í˜¸ì¶œ
* Google Places í˜¸ì¶œ
* Vercel ì‚¬ìš©ëŸ‰
* Toss Payments ìˆ˜ìˆ˜ë£Œ
* ë‹¨ë°œì„± ìˆ˜ìµ(300~500ì›/íšŒ)

---

# 11. **QA ë° í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­ (í•µì‹¬ ì¶”ê°€ ì„¹ì…˜)**

LateProofëŠ” ì‚¬ì§„ ê²€ì¦/ê²°ì œ/AI í•©ì„± ë“± ì˜¤ë¥˜ ìš”ì†Œê°€ ë§ê¸° ë•Œë¬¸ì—
**â€œì‚¬ìš©ì ì•ˆì „ì„ ìœ„í•œ ìµœì†Œ ë³´ì¥ + í•µì‹¬ ë¡œì§ ì™„ì „ í…ŒìŠ¤íŠ¸â€**ë¥¼ ëª©í‘œë¡œ í•œë‹¤.

---

## 11.1 í…ŒìŠ¤íŠ¸ ë„êµ¬

* **Unit/Integration**: Vitest
* **Component/UI**: React Testing Library
* **API Mock**: MSW
* **E2E**: Playwright

---

## 11.2 í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ë²”ìœ„

### **(1) Unit Test**

* Step FSM
* ì–¼êµ´ ê²€ì¦ ë¡œì§
* Nanobanana payload builder
* ì¥ì†Œ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ìƒì„±
* ì´ë¯¸ì§€ ì¬ìƒì„± ë¡œì§
* íŒŒì¼ ì—…ë¡œë“œ orientation ì²˜ë¦¬

### **(2) Integration Test**

* ì—…ë¡œë“œ â†’ ê²€ì¦ PASS íë¦„
* ê²€ì¦ FAIL â†’ Step ë¡¤ë°±
* ê²°ì œ ì„±ê³µ ì‹œ Step ì´ë™
* 3ì¥ ìƒì„± ì‘ë‹µ ì²˜ë¦¬
* ë‹¨ì¼ ì¬ìƒì„± í”„ë¡œì„¸ìŠ¤

### **(3) E2E Test (2ê°œ)**

* Photo Mode Happy Path
* Map Mode Happy Path

> ë‹¨, Azure/Nanobanana/Google/Toss ë“± **ë¹„ìš© ë°œìƒ APIëŠ” ëª¨ë‘ Mock(MSW)**

---

## 11.3 í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ëª©í‘œ

* Unit + Integration: **50% ì´ìƒ**
* Step FSM + Face ê²€ì¦ + Generate ë¡œì§: **100% í•„ìˆ˜ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ**
* E2EëŠ” Happy Pathë§Œ ì¡´ì¬í•˜ë¯€ë¡œ ì»¤ë²„ë¦¬ì§€ ì œì™¸

---

# 12. **Storybook ìš´ì˜ ì •ì±… (ì‹ ê·œ)**

## 12.1 ëª©ì 

* Design System ê²€ì¦
* í•µì‹¬ UI ì¹´íƒˆë¡œê·¸
* Style Guide ì¤€ìˆ˜ ì—¬ë¶€ í™•ì¸
* ê°œë°œì ìŠ¤ìŠ¤ë¡œ UI regression ìµœì†Œí™”

## 12.2 Storybook ë²”ìœ„

### í¬í•¨

* Button
* Input
* Modal
* Marker(ì¸ë¬¼ ì„ íƒ ì›)
* í‘œì • ì„ íƒ UI
* Dropzone
* Result Image Card
* Loading Shimmer
* Navigation / Step Indicator

### ì œì™¸

* í˜ì´ì§€ ë‹¨ìœ„ ì»´í¬ë„ŒíŠ¸
* Step ê¸°ë°˜ Flow ìŠ¤í† ë¦¬
* API Mock ê¸°ë°˜ ìŠ¤í† ë¦¬
* ì§€ë„ UI ì „ì²´

## 12.3 Storybook íŒŒì¼ ìœ„ì¹˜

```
shared/ui/[component]/index.tsx
shared/ui/[component]/[component].stories.tsx
```

---

# 13. ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

(SG.md ë³„ë„ ë¬¸ì„œí™” â€” ë§í¬ë§Œ PRDì— ëª…ì‹œ)

* ë¸Œëœë“œ í‚¤ì›Œë“œ: ì€ë°€í•¨ / ìì—°ìŠ¤ëŸ¬ì›€
* ë¸Œëœë“œ ë¬¸ì¥: â€œì—„ë§ˆ ì € ì¹œêµ¬ë‘ ë†€ê³ ìˆì–´ìš”!â€
* ë³´ëë¹› ë¯¸ë‹ˆë©€ ì»¬ëŸ¬ ì‹œìŠ¤í…œ
* UI/Animation/AI ìŠ¤íƒ€ì¼ ì •ì˜

---

# **Appendix A â€” Test Scenarios**

---

## **A.1 Photo Mode Happy Path**

| Step | Action        | Input      | Expected Result  |
| ---- | ------------- | ---------- | ---------------- |
| 1    | Photo Mode ì„ íƒ | â€”          | Step â†’ UPLOAD    |
| 2    | ì´ë¯¸ì§€ ì—…ë¡œë“œ       | sample.jpg | ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ          |
| 3    | ì–¼êµ´ ìœ„ì¹˜ ì¡°ì •      | ì› 2ê°œ       | ì¢Œí‘œ Mapping ì™„ë£Œ    |
| 4    | ì–¼êµ´ ê²€ì¦         | Mock PASS  | Step â†’ PAYMENT   |
| 5    | ê²°ì œ            | Mock ì„±ê³µ    | Step â†’ GENERATE  |
| 6    | AI ìƒì„± ìš”ì²­      | Mock 3ì¥    | Step â†’ RESULT    |
| 7    | ê²°ê³¼ í™•ì¸         | â€”          | 3ì¥ ë Œë”ë§ / ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥ |

---

## **A.2 Map Mode Happy Path**

| Step | Action      | Input     | Expected Result |
| ---- | ----------- | --------- | --------------- |
| 1    | Map Mode ì„ íƒ | â€”         | ì§€ë„ í‘œì‹œ           |
| 2    | ì¥ì†Œ ê²€ìƒ‰       | â€œí™ëŒ€ì…êµ¬â€    | Mock ì¥ì†Œ ë¦¬ìŠ¤íŠ¸     |
| 3    | ì¥ì†Œ ì„ íƒ       | PlaceId   | í”„ë¡¬í”„íŠ¸ ìƒì„± ì™„ë£Œ      |
| 4    | ì› ë§¤ì¹­        | 1~3ê°œ      | ì¢Œí‘œ ì§€ì •           |
| 5    | ì–¼êµ´ ê²€ì¦       | Mock PASS | Step â†’ PAYMENT  |
| 6    | ê²°ì œ          | Mock ì„±ê³µ   | Step â†’ GENERATE |
| 7    | AI ìƒì„± ìš”ì²­    | Mock 3ì¥   | Step â†’ RESULT   |
| 8    | ê²°ê³¼ í™•ì¸       | â€”         | 3ì¥ Node ë Œë”ë§     |



<!-- Source: .ruler/SG.md -->

# LateProof â€” Style Guide (SG.md)

> **ëª©ì **: í”„ë¡œì íŠ¸ ì „ë°˜ì˜ ì¼ê´€ëœ ë””ìì¸ ì‹œìŠ¤í…œ ì •ì˜  
> **Last Updated**: 2025-12-09

---

## ğŸ¨ ë¸Œëœë“œ ì •ì²´ì„±

### í‚¤ì›Œë“œ
- **ì€ë°€í•¨**: ìì—°ìŠ¤ëŸ½ê³  ëˆˆì— ë„ì§€ ì•ŠëŠ” UX
- **ìì—°ìŠ¤ëŸ¬ì›€**: ì§„ì§œ ê°™ì€ AI ì´ë¯¸ì§€ ìƒì„±

### ë¸Œëœë“œ ë¬¸ì¥
> "ì—„ë§ˆ ì € ì¹œêµ¬ë‘ ë†€ê³ ìˆì–´ìš”!"

ê²½ì¾Œí•˜ë©´ì„œë„ ì‹ ë¢°ê°ì„ ì£¼ëŠ” í†¤ ìœ ì§€

### ë””ìì¸ ì² í•™
- ë³´ëë¹› ë¯¸ë‹ˆë©€ ì»¬ëŸ¬ ì‹œìŠ¤í…œ
- ì•„ì´í° ì´¬ì˜ í†¤ê³¼ ìœ ì‚¬í•œ ìì—°ê°
- ê²ŒìŠ¤íŠ¸ ê¸°ë°˜ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ë‹¨ìˆœí•¨

---

## ğŸ¥· Stealth UX ê·œì¹™

### í•µì‹¬ ì›ì¹™
AI ê¸°ìˆ ì„ ì „ë©´ì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , ìì—°ìŠ¤ëŸ¬ìš´ ì¼ìƒ ì–¸ì–´ë¡œ ì‚¬ìš©ì ê²½í—˜ì„ êµ¬ì„±í•œë‹¤.  
ë¸Œëœë“œ ë¬¸ì¥ **"ì—„ë§ˆ ì € ì¹œêµ¬ë‘ ë†€ê³ ìˆì–´ìš”!"**ì˜ ë§¥ë½ì— ë¶€í•©í•˜ëŠ” ì€ë°€í•˜ê³  í¸ì•ˆí•œ í†¤ì„ ìœ ì§€í•œë‹¤.

---

### 1. AI/í•©ì„± ë‹¨ì–´ ë…¸ì¶œ ìµœì†Œí™”

**í”¼í•´ì•¼ í•  í‘œí˜„**:
- "AIê°€ ìƒì„± ì¤‘ì…ë‹ˆë‹¤"
- "ì´ë¯¸ì§€ë¥¼ í•©ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤"
- "ì¸ê³µì§€ëŠ¥ì´ ë¶„ì„ ì¤‘..."
- "ë”¥ëŸ¬ë‹ ëª¨ë¸ ì²˜ë¦¬"

**ê¶Œì¥ í‘œí˜„**:
- "ì‚¬ì§„ì„ ì¤€ë¹„í•˜ê³  ìˆì–´ìš”"
- "ìì—°ìŠ¤ëŸ½ê²Œ ì •ë¦¬ ì¤‘ì´ì—ìš”"
- "ê±°ì˜ ë‹¤ ëì–´ìš”"
- "ë§ˆë¬´ë¦¬í•˜ê³  ìˆì–´ìš”"

**ì ìš© ì˜ˆì‹œ**:
```tsx
// âŒ Bad
<Loading>AIê°€ ì´ë¯¸ì§€ë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</Loading>

// âœ… Good
<Loading>ì‚¬ì§„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì •ë¦¬í•˜ê³  ìˆì–´ìš”</Loading>
```

---

### 2. ë¡œë”© ë¬¸êµ¬ â€” ìƒí™© ì–¸ì–´ ì¤‘ì‹¬

ê¸°ìˆ ì  í”„ë¡œì„¸ìŠ¤ê°€ ì•„ë‹Œ, ì‚¬ìš©ìê°€ ê¸°ë‹¤ë¦¬ëŠ” **ê²°ê³¼**ì— ì´ˆì ì„ ë§ì¶˜ë‹¤.

| Step | âŒ ê¸°ìˆ  ì„¤ëª… | âœ… ìƒí™© ì–¸ì–´ |
|------|-----------|-----------|
| ì—…ë¡œë“œ | íŒŒì¼ì„ ì—…ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤ | ì‚¬ì§„ì„ ì˜¬ë¦¬ëŠ” ì¤‘ì´ì—ìš” |
| ì–¼êµ´ ê²€ì¦ | AIê°€ ì–¼êµ´ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤ | ì‚¬ì§„ì„ í™•ì¸í•˜ê³  ìˆì–´ìš” |
| ìƒì„± | ì´ë¯¸ì§€ë¥¼ í•©ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤ | ê±°ì˜ ë‹¤ ëì–´ìš” |
| ì¬ìƒì„± | ì¬ìƒì„± ìš”ì²­ ì²˜ë¦¬ ì¤‘ | ë‹¤ì‹œ ì •ë¦¬í•˜ê³  ìˆì–´ìš” |
| ë‹¤ìš´ë¡œë“œ | íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤ | ì‚¬ì§„ì„ ì €ì¥í•˜ê³  ìˆì–´ìš” |

**í†¤ ê·œì¹™**:
- **~ì¤‘ì…ë‹ˆë‹¤** âŒ â†’ **~í•˜ê³  ìˆì–´ìš”** âœ…
- ì§„í–‰ë¥ ì€ ë°±ë¶„ìœ¨(%) ëŒ€ì‹  ë‹¨ê³„ í‘œí˜„: "1/3 ì™„ë£Œ", "ê±°ì˜ ë‹¤ ëì–´ìš”"
- ê¸°ìˆ  ì˜¤ë¥˜ ë¬¸êµ¬ë„ ì¼ìƒ ì–¸ì–´ë¡œ: "ì ì‹œ ë¬¸ì œê°€ ìƒê²¼ì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”"

---

### 3. CTA â€” ì¼ìƒì  í‘œí˜„ ìš°ì„ 

**í”¼í•´ì•¼ í•  í‘œí˜„**:
- "AI ìƒì„±í•˜ê¸°"
- "ì´ë¯¸ì§€ í•©ì„± ì‹œì‘"
- "ì²˜ë¦¬ ìš”ì²­"
- "ë³€í™˜í•˜ê¸°"

**ê¶Œì¥ í‘œí˜„**:
- "ë§Œë“¤ê¸°"
- "ë‹¤ìŒìœ¼ë¡œ"
- "í™•ì¸í•˜ê¸°"
- "ì €ì¥í•˜ê¸°"
- "ë‹¤ì‹œ í•´ë³´ê¸°"

**ì ìš© ì˜ˆì‹œ**:
```tsx
// âŒ Bad
<Button>AI ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°</Button>

// âœ… Good
<Button>ë§Œë“¤ê¸°</Button>

// âŒ Bad
<Button>ì¬ìƒì„± ìš”ì²­</Button>

// âœ… Good
<Button>ë‹¤ì‹œ í•´ë³´ê¸°</Button>
```

---

### 4. ê²°ì œ ë‹¨ê³„ â€” ê°•ì¡° ì œí•œ

ê²°ì œëŠ” í•„ìˆ˜ ë‹¨ê³„ì´ì§€ë§Œ, ê³¼ë„í•œ ê°•ì¡°ëŠ” ì‚¬ìš©ìì—ê²Œ ë¶€ë‹´ì„ ì¤€ë‹¤.

**UI ê·œì¹™**:
- ~~ë¹¨ê°„ìƒ‰ ê°•ì¡°~~ â†’ ë¸Œëœë“œ Purple ìœ ì§€
- ~~"ì§€ê¸ˆ ê²°ì œí•˜ì„¸ìš”!"~~ â†’ "í™•ì¸í•˜ê¸°"
- ~~ê¹œë¹¡ì´ëŠ” ì• ë‹ˆë©”ì´ì…˜~~ â†’ ë¶€ë“œëŸ¬ìš´ fade-in
- ~~í° í°íŠ¸ë¡œ ê°€ê²© ê°•ì¡°~~ â†’ ì¤‘ë¦½ì  í¬ê¸° (`text-base`, `text-lg`)

**ê²°ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼**:
```tsx
// âŒ Bad - ê³¼ë„í•œ ê°•ì¡°
<Button 
  variant="destructive" 
  size="xl"
  className="animate-pulse"
>
  ğŸ”¥ ì§€ê¸ˆ ë°”ë¡œ ê²°ì œí•˜ì„¸ìš”!
</Button>

// âœ… Good - ìì—°ìŠ¤ëŸ¬ìš´ íë¦„
<Button 
  variant="default" 
  size="default"
>
  í™•ì¸í•˜ê¸°
</Button>
```

**ê°€ê²© í‘œì‹œ**:
```tsx
// âŒ Bad
<div className="text-4xl font-bold text-error">
  â‚©500 <span className="text-xs">ë‹¨ í•˜ë£¨ë§Œ!</span>
</div>

// âœ… Good
<div className="text-lg text-neutral-700">
  â‚©500
</div>
```

---

### 5. ì—ëŸ¬/ê²½ê³  ë©”ì‹œì§€

ê¸°ìˆ ì  ì˜¤ë¥˜ë„ ì¼ìƒ ì–¸ì–´ë¡œ ë²ˆì—­í•œë‹¤.

| ì˜¤ë¥˜ ìƒí™© | âŒ ê¸°ìˆ  ë©”ì‹œì§€ | âœ… ì¼ìƒ ì–¸ì–´ |
|----------|-------------|-----------|
| ì–¼êµ´ ê²€ì¦ ì‹¤íŒ¨ | Face detection failed | ì‚¬ì§„ì—ì„œ ì–¼êµ´ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ìš” |
| íŒŒì¼ ìš©ëŸ‰ ì´ˆê³¼ | File size exceeds 10MB | ì‚¬ì§„ í¬ê¸°ê°€ ë„ˆë¬´ ì»¤ìš” (10MB ì´í•˜) |
| API ì˜¤ë¥˜ | 500 Internal Server Error | ì ì‹œ ë¬¸ì œê°€ ìƒê²¼ì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš” |
| ê²°ì œ ì‹¤íŒ¨ | Payment gateway timeout | ê²°ì œê°€ ì™„ë£Œë˜ì§€ ì•Šì•˜ì–´ìš” |
| ì¬ìƒì„± ì œí•œ | Regeneration limit reached | ì¬ì‹œë„ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆì–´ìš” |

**í†¤ ê·œì¹™**:
- ë‹¨ì •ì  ë¶€ì •ë¬¸(~í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤) â†’ ë¶€ë“œëŸ¬ìš´ ì„¤ëª…(~ì–´ìš”)
- ì—ëŸ¬ ì½”ë“œ ë…¸ì¶œ ìµœì†Œí™”
- í•´ê²° ë°©ë²•ì„ í•¨ê»˜ ì œì‹œ: "ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”", "ë‹¤ë¥¸ ì‚¬ì§„ì„ ì˜¬ë ¤ë³´ì„¸ìš”"

---

### 6. UI ì»´í¬ë„ŒíŠ¸ë³„ ì ìš©

#### ë¡œë”© ìŠ¤í”¼ë„ˆ
```tsx
// âŒ Bad
<Spinner>AI Processing...</Spinner>

// âœ… Good
<Spinner>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</Spinner>
```

#### Toast ì•Œë¦¼
```tsx
// âŒ Bad
toast.success('Image synthesis completed successfully');

// âœ… Good
toast.success('ì‚¬ì§„ì´ ì¤€ë¹„ëì–´ìš”');
```

#### ë‹¨ê³„ í‘œì‹œ
```tsx
// âŒ Bad
<Steps>
  <Step>Upload</Step>
  <Step>AI Processing</Step>
  <Step>Result</Step>
</Steps>

// âœ… Good
<Steps>
  <Step>ì‚¬ì§„ ì˜¬ë¦¬ê¸°</Step>
  <Step>í™•ì¸í•˜ê¸°</Step>
  <Step>ì™„ë£Œ</Step>
</Steps>
```

---

### 7. ì¹´í”¼ë¼ì´íŒ… ì›ì¹™

**DO**:
- 2ì¸ì¹­ ì¡´ëŒ“ë§ ì‚¬ìš© (~í•´ì£¼ì„¸ìš”, ~í•˜ì‹œê² ì–´ìš”?)
- ì§§ê³  ëª…í™•í•œ ë¬¸ì¥
- ê¸ì •ì  ì–´ì¡° ìœ ì§€
- í–‰ë™ ìœ ë„ëŠ” ë¶€ë“œëŸ½ê²Œ

**DON'T**:
- ê¸°ìˆ  ìš©ì–´ ë‚¨ë°œ
- AI/í•©ì„±/ì•Œê³ ë¦¬ì¦˜ ë“± ë‹¨ì–´ ë…¸ì¶œ
- ê³¼ì¥ëœ í‘œí˜„ ("ì„¸ê³„ ìµœê³ ", "í˜ì‹ ì ")
- ì••ë°•ê° ì¡°ì„± ("ì§€ê¸ˆ ë°”ë¡œ", "ì„œë‘ë¥´ì„¸ìš”")

---

### 8. ì ‘ê·¼ì„±ê³¼ì˜ ê· í˜•

Stealth UXëŠ” ìŠ¤í¬ë¦° ë¦¬ë” ì‚¬ìš©ìì—ê²Œë„ ëª…í™•í•´ì•¼ í•œë‹¤.

```tsx
// âœ… Good - aria-labelì€ ëª…í™•í•˜ê²Œ
<button aria-label="ì‚¬ì§„ ìƒì„±í•˜ê¸°">
  ë§Œë“¤ê¸°
</button>

// âœ… Good - Loading ìƒíƒœ ëª…í™•íˆ
<div role="status" aria-live="polite">
  ì‚¬ì§„ì„ ì¤€ë¹„í•˜ê³  ìˆì–´ìš”
</div>
```

---

## ğŸ¯ Stealth UX ì²´í¬ë¦¬ìŠ¤íŠ¸

í”„ë¡œë•ì…˜ ë°°í¬ ì „ í™•ì¸:

- [ ] ëª¨ë“  ë¡œë”© ë©”ì‹œì§€ì—ì„œ "AI", "í•©ì„±", "ìƒì„±" ì œê±°
- [ ] CTA ë²„íŠ¼ í…ìŠ¤íŠ¸ ì¼ìƒ ì–¸ì–´ë¡œ ë³€ê²½
- [ ] ê²°ì œ í™”ë©´ ê³¼ë„í•œ ê°•ì¡° ì œê±°
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ ì¼ìƒ ì–¸ì–´ë¡œ ë²ˆì—­
- [ ] Toast ì•Œë¦¼ í†¤ ì ê²€
- [ ] Step Indicator ë¼ë²¨ í™•ì¸
- [ ] ìŠ¤í¬ë¦° ë¦¬ë” í…ŒìŠ¤íŠ¸ (aria-label ëª…í™•ì„±)

---

## ğŸŒˆ ìƒ‰ìƒ íŒ”ë ˆíŠ¸

### Primary (Purple â€” ë¸Œëœë“œ ë©”ì¸)

```css
--color-brand-50: #faf5ff    /* ë°°ê²½ ê°•ì¡°, hover ìƒíƒœ */
--color-brand-100: #f3e8ff   /* ì„œë¸Œ ë°°ê²½ */
--color-brand-200: #e9d5ff   /* ë¹„í™œì„± ìƒíƒœ */
--color-brand-500: #a855f7   /* ë©”ì¸ ë¸Œëœë“œ ì»¬ëŸ¬ */
--color-brand-600: #9333ea   /* hover/active ìƒíƒœ */
--color-brand-700: #7e22ce   /* ê°•ì¡° í…ìŠ¤íŠ¸ */
--color-brand-900: #581c87   /* í—¤ë”©, ê°•í•œ ê°•ì¡° */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- Primary Button: `bg-brand-500 hover:bg-brand-600`
- ë§í¬: `text-brand-700 hover:text-brand-600`
- ë°°ê²½ ê°•ì¡°: `bg-brand-50`

---

### Neutral (Gray â€” í…ìŠ¤íŠ¸/UI ê¸°ë°˜)

```css
--color-neutral-50: #fafafa   /* ì¹´ë“œ ë°°ê²½ */
--color-neutral-100: #f5f5f5  /* ì…ë ¥ í•„ë“œ ë°°ê²½ */
--color-neutral-200: #e5e5e5  /* êµ¬ë¶„ì„  */
--color-neutral-400: #a3a3a3  /* ë¹„í™œì„± í…ìŠ¤íŠ¸ */
--color-neutral-500: #737373  /* ë³´ì¡° í…ìŠ¤íŠ¸ */
--color-neutral-700: #404040  /* ì„œë¸Œ í—¤ë”© */
--color-neutral-900: #171717  /* ì£¼ í…ìŠ¤íŠ¸ */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- ì£¼ í…ìŠ¤íŠ¸: `text-neutral-900`
- ë³´ì¡° í…ìŠ¤íŠ¸: `text-neutral-500`
- Border: `border-neutral-200`

---

### Accent (Violet/Indigo â€” ì¸í„°ë™í‹°ë¸Œ ìš”ì†Œ)

```css
--color-accent-400: #a78bfa  /* Focus ring, ì„ íƒ ìƒíƒœ */
--color-accent-500: #8b5cf6  /* Interactive hover */
--color-indigo-500: #6366f1  /* ë§í¬, CTA ë²„íŠ¼ ë³´ì¡° */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- Focus ring: `ring-accent-400`
- Interactive hover: `hover:bg-accent-500`

---

### Semantic (ìƒíƒœ í”¼ë“œë°±)

```css
--color-success: #22c55e   /* ì„±ê³µ, ì™„ë£Œ */
--color-warning: #f59e0b   /* ê²½ê³ , ì£¼ì˜ */
--color-error: #ef4444     /* ì˜¤ë¥˜, ì‹¤íŒ¨ */
--color-info: #3b82f6      /* ì •ë³´, ì•ˆë‚´ */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- ì„±ê³µ Toast: `bg-success text-white`
- ì˜¤ë¥˜ ë©”ì‹œì§€: `text-error`

---

## ğŸ“ íƒ€ì´í¬ê·¸ë˜í”¼

### Font Family

```css
--font-sans: system-ui, -apple-system, "Pretendard", "Apple SD Gothic Neo", sans-serif;
--font-mono: "SF Mono", Menlo, Monaco, Consolas, monospace;
```

- **ë³¸ë¬¸**: `font-sans` ì‚¬ìš©
- **ì½”ë“œ/ë°ì´í„°**: `font-mono` ì‚¬ìš©

---

### Font Size

| í† í° | í¬ê¸° (rem) | í¬ê¸° (px) | ìš©ë„ |
|------|-----------|----------|------|
| `xs` | 0.75rem | 12px | Caption, ë¼ë²¨ |
| `sm` | 0.875rem | 14px | ë³´ì¡° í…ìŠ¤íŠ¸ |
| `base` | 1rem | 16px | ë³¸ë¬¸ |
| `lg` | 1.125rem | 18px | ë¶€ì œëª© |
| `xl` | 1.25rem | 20px | ì†Œì œëª© |
| `2xl` | 1.5rem | 24px | ì„¹ì…˜ ì œëª© |
| `3xl` | 1.875rem | 30px | í˜ì´ì§€ ì œëª© |
| `4xl` | 2.25rem | 36px | Hero ì œëª© |

---

### Font Weight

| í† í° | ê°’ | ìš©ë„ |
|------|-----|------|
| `regular` | 400 | ë³¸ë¬¸ |
| `medium` | 500 | ê°•ì¡° í…ìŠ¤íŠ¸ |
| `semibold` | 600 | ë²„íŠ¼, ë¼ë²¨ |
| `bold` | 700 | í—¤ë”© |

---

### Line Height

| í† í° | ê°’ | ìš©ë„ |
|------|-----|------|
| `tight` | 1.25 | í—¤ë”© |
| `normal` | 1.5 | ë³¸ë¬¸ |
| `relaxed` | 1.75 | ê¸´ í…ìŠ¤íŠ¸ |

---

### Typography Presets

```css
/* Heading 1 */
.heading-1 {
  font-size: 2.25rem; /* 36px */
  font-weight: 700;
  line-height: 1.25;
  color: var(--color-neutral-900);
}

/* Heading 2 */
.heading-2 {
  font-size: 1.875rem; /* 30px */
  font-weight: 600;
  line-height: 1.25;
  color: var(--color-neutral-900);
}

/* Body Large */
.body-lg {
  font-size: 1.125rem; /* 18px */
  line-height: 1.75;
  color: var(--color-neutral-700);
}

/* Body Regular */
.body {
  font-size: 1rem; /* 16px */
  line-height: 1.5;
  color: var(--color-neutral-900);
}

/* Body Small */
.body-sm {
  font-size: 0.875rem; /* 14px */
  line-height: 1.5;
  color: var(--color-neutral-700);
}

/* Caption */
.caption {
  font-size: 0.75rem; /* 12px */
  color: var(--color-neutral-500);
}
```

---

## ğŸ“ Spacing System

**8px ê¸°ë°˜ ì‹œìŠ¤í…œ** ì‚¬ìš©

| í† í° | ê°’ (rem) | ê°’ (px) | ìš©ë„ |
|------|---------|---------|------|
| `0.5` | 0.125rem | 2px | ì•„ì´ì½˜ ê°„ê²© |
| `1` | 0.25rem | 4px | ë¯¸ì„¸ ê°„ê²© |
| `2` | 0.5rem | 8px | ìµœì†Œ ê°„ê²© |
| `3` | 0.75rem | 12px | ì‘ì€ ê°„ê²© |
| `4` | 1rem | 16px | ê¸°ë³¸ ê°„ê²© |
| `5` | 1.25rem | 20px | ì¤‘ê°„ ê°„ê²© |
| `6` | 1.5rem | 24px | ì„¹ì…˜ ë‚´ ê°„ê²© |
| `8` | 2rem | 32px | í° ê°„ê²© |
| `10` | 2.5rem | 40px | ì„¹ì…˜ ê°„ê²© |
| `12` | 3rem | 48px | í˜ì´ì§€ ì—¬ë°± |
| `16` | 4rem | 64px | í° í˜ì´ì§€ ì—¬ë°± |
| `20` | 5rem | 80px | Hero ì„¹ì…˜ ì—¬ë°± |

---

## ğŸ“± Breakpoints

```css
/* Mobile First ë°©ì‹ */
sm: 640px   /* ì‘ì€ íƒœë¸”ë¦¿ */
md: 768px   /* íƒœë¸”ë¦¿ */
lg: 1024px  /* ë°ìŠ¤í¬íƒ‘ */
xl: 1280px  /* í° ë°ìŠ¤í¬íƒ‘ */
2xl: 1536px /* ì™€ì´ë“œ ìŠ¤í¬ë¦° */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```html
<div class="px-4 md:px-8 lg:px-12">
  <!-- ëª¨ë°”ì¼: 16px, íƒœë¸”ë¦¿: 32px, ë°ìŠ¤í¬íƒ‘: 48px -->
</div>
```

---

## ğŸ¯ Border Radius

```css
--radius-sm: 0.375rem  /* 6px - ì‘ì€ ìš”ì†Œ */
--radius-md: 0.5rem    /* 8px - ê¸°ë³¸ */
--radius-lg: 0.625rem  /* 10px - ì¹´ë“œ, ë²„íŠ¼ */
--radius-xl: 0.75rem   /* 12px - ëª¨ë‹¬ */
--radius-2xl: 1rem     /* 16px - Hero ìš”ì†Œ */
--radius-full: 9999px  /* ì™„ì „í•œ ì›í˜• */
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- Button: `rounded-lg` (10px)
- Card: `rounded-lg` (10px)
- Modal: `rounded-xl` (12px)
- Avatar: `rounded-full`

---

## ğŸ­ Shadow System

```css
--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
--shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
```

**ì‚¬ìš© ì˜ˆì‹œ**:
- Card: `shadow-md`
- Modal: `shadow-xl`
- Dropdown: `shadow-lg`
- Button hover: `shadow-lg`

---

## âš¡ Animation & Transition

### Duration

```css
--duration-fast: 150ms    /* ë§ˆì´í¬ë¡œ ì¸í„°ë™ì…˜ */
--duration-base: 200ms    /* ê¸°ë³¸ ì „í™˜ */
--duration-slow: 300ms    /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ */
--duration-slower: 500ms  /* í˜ì´ì§€ ì „í™˜ */
```

### Easing

```css
--ease-in: cubic-bezier(0.4, 0, 1, 1);
--ease-out: cubic-bezier(0, 0, 0.2, 1);
--ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```css
.button {
  transition: background-color var(--duration-base) var(--ease-out);
}
```

---

## ğŸ”˜ Component Guidelines

### Button Variants

**Primary**
```tsx
<button className="bg-brand-500 hover:bg-brand-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200">
  ì‹œì‘í•˜ê¸°
</button>
```

**Secondary**
```tsx
<button className="bg-brand-100 hover:bg-brand-200 text-brand-900 px-6 py-3 rounded-lg font-semibold transition-colors duration-200">
  ìì„¸íˆ ë³´ê¸°
</button>
```

**Ghost**
```tsx
<button className="hover:bg-brand-50 text-brand-700 px-4 py-2 rounded-lg transition-colors duration-200">
  ê±´ë„ˆë›°ê¸°
</button>
```

---

### Input Fields

```tsx
<input 
  type="text" 
  className="w-full px-4 py-3 bg-neutral-100 border border-neutral-200 rounded-lg focus:ring-2 focus:ring-accent-400 focus:border-transparent transition-all duration-200"
  placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
/>
```

---

### Cards

```tsx
<div className="bg-white p-6 rounded-lg shadow-md border border-neutral-200 hover:shadow-lg transition-shadow duration-200">
  {/* Card Content */}
</div>
```

---

## ğŸ¨ AI ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

### ë°°ê²½ ì²˜ë¦¬
- ì›ë³¸ ë°°ê²½ 100% ìœ ì§€
- ì¡°ëª… ìë™ ì¡°ì ˆ
- ìì—°ìŠ¤ëŸ¬ìš´ ê·¸ë¦¼ì ìƒì„±

### ì¸ë¬¼ ì²˜ë¦¬
- ì•„ì´í° ì´¬ì˜ í†¤ ëª¨ë°©
- í”¼ë¶€í†¤ ìì—°ê° ìš°ì„ 
- í‘œì •ì€ ì´ëª¨ì§€ ê¸°ë°˜ ì„ íƒ
- ìµœëŒ€ 5ëª…ê¹Œì§€ ìƒì„± ê°€ëŠ¥

### í”„ë¡¬í”„íŠ¸ í‚¤ì›Œë“œ
```
natural lighting, iPhone photography style, realistic skin tone, 
candid moment, soft shadows, authentic atmosphere
```

---

## ğŸ“‹ Accessibility

### Focus States
- ëª¨ë“  ì¸í„°ë™í‹°ë¸Œ ìš”ì†Œì— `focus:ring-2 focus:ring-accent-400` ì ìš©
- Tab navigation ì™„ì „ ì§€ì›

### Color Contrast
- í…ìŠ¤íŠ¸ ëŒ€ë¹„ìœ¨ ìµœì†Œ 4.5:1 (WCAG AA ê¸°ì¤€)
- ì£¼ í…ìŠ¤íŠ¸: `text-neutral-900` on `bg-white`
- ë³´ì¡° í…ìŠ¤íŠ¸: `text-neutral-500` on `bg-white`

### Screen Reader
- ì¤‘ìš” ì´ë¯¸ì§€ì— `alt` ì†ì„± í•„ìˆ˜
- Interactive ìš”ì†Œì— `aria-label` ì œê³µ
- Form ì…ë ¥ í•„ë“œì— `<label>` ì—°ê²°

---

## ğŸš€ Usage in Code

### Tailwind Class Example

```tsx
// Primary Button
<button className="bg-brand-500 hover:bg-brand-600 active:bg-brand-700 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all duration-200">
  ìƒì„±í•˜ê¸°
</button>

// Card with hover effect
<div className="bg-white rounded-lg p-6 shadow-md hover:shadow-xl transition-shadow duration-300 border border-neutral-200">
  <h3 className="text-2xl font-bold text-neutral-900 mb-2">ì œëª©</h3>
  <p className="text-neutral-500">ì„¤ëª… í…ìŠ¤íŠ¸</p>
</div>

// Typography
<h1 className="text-4xl font-bold text-neutral-900 leading-tight">
  LateProof
</h1>
<p className="text-lg text-neutral-700 leading-relaxed">
  ì¦‰ì„ ì¸ì¦ìƒ· ìƒì„± ì„œë¹„ìŠ¤
</p>
```

---

## âœ… Acceptance Criteria Checklist

- [x] SG.md íŒŒì¼ ìƒì„± ì™„ë£Œ
- [x] Tailwind configì— ì»¤ìŠ¤í…€ í† í° ë°˜ì˜ (@theme ë¸”ë¡)
- [x] ìƒ‰ìƒ ë³€ìˆ˜ ì •ì˜ ì™„ë£Œ (Brand Purple, Neutral, Accent, Semantic)
- [x] í°íŠ¸ ì‹œìŠ¤í…œ ì •ì˜ ì™„ë£Œ (Font Family, Size, Weight, Line Height)
- [x] ê°„ê²© ì‹œìŠ¤í…œ ì •ì˜ ì™„ë£Œ (8px ê¸°ë°˜ Spacing)
- [x] Button ì»´í¬ë„ŒíŠ¸ì— ìŠ¤íƒ€ì¼ ì ìš© (ë¸Œëœë“œ Purple ìƒ‰ìƒ)
- [ ] Storybookì—ì„œ ìŠ¤íƒ€ì¼ ê²€ì¦ (ë‹¤ìŒ Task: M1-E3-T05)

---

## ğŸ“š References

- [Tailwind CSS v4 Documentation](https://tailwindcss.com)
- [Shadcn/UI](https://ui.shadcn.com)
- [OKLCH Color Space](https://oklch.com)
- [WCAG Accessibility Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)



<!-- Source: .ruler/TASKS.md -->

# LateProof â€” Tasks

ì•„ë˜ Taskë“¤ì€ Milestone â†’ Epic â†’ Task ìˆœì˜ êµ¬ì¡°ë¥¼ ê°€ì§€ë©°,  
ëª¨ë“  TaskëŠ” ì²´í¬ë°•ìŠ¤ë¡œ ì¶”ì  ê°€ëŠ¥í•©ë‹ˆë‹¤.

ID ê·œì¹™:  
`M{Milestone}-E{Epic}-T{TaskNumber}`  
ì˜ˆ: M2-E3-T04

---

# Milestone 1 â€” Foundation Setup

## Epic 1.1 â€” Repository & Environment
- [x] M1-E1-T01: GitHub Repository ìƒì„±
- [x] M1-E1-T02: README ì´ˆê¸° í…œí”Œë¦¿ ì‘ì„±
- [x] M1-E1-T03: Biome ì´ˆê¸° ì„¤ì •
- [x] M1-E1-T03-1: Lefthook Git Hooks ì„¤ì •
- [x] M1-E1-T04: Vercel í”„ë¡œì íŠ¸ ìƒì„±
- [x] M1-E1-T05: í™˜ê²½ ë³€ìˆ˜ êµ¬ì¡° ì„¤ê³„

## Epic 1.2 â€” Next.js + FSD êµ¬ì¡°
- [x] M1-E2-T01: Next.js App Router ì´ˆê¸°í™”
- [x] M1-E2-T02: src/ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
- [x] M1-E2-T03: FSD Layer êµ¬ì¶•(app/features/entities/shared)

## Epic 1.3 â€” UI Design System & Storybook
- [x] M1-E3-T01: TailwindCSS ì„¤ì¹˜
- [x] M1-E3-T02: Shadcn ì´ˆê¸°í™”
- [x] M1-E3-T03: ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸ ì‘ì„±(Button/Input/Modal ë“±) â€” Buttonë§Œ ì™„ë£Œ
- [x] M1-E3-T04: SG.md ê¸°ë°˜ ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ êµ¬ì¶•
- [x] M1-E3-T05: Storybook ì„¤ì¹˜

## Epic 1.4 â€” Testing Environment Setup
- [x] M1-E4-T01: Vitest ì„¤ì¹˜ ë° ì„¤ì •
- [x] M1-E4-T02: Testing Library ì„¤ì¹˜ ë° setup íŒŒì¼ ì‘ì„±
- [x] M1-E4-T03: MSW ì„¤ì¹˜ ë° í•¸ë“¤ëŸ¬ êµ¬ì¡° ìƒì„±
- [x] M1-E4-T04: Playwright ì„¤ì¹˜ ë° ì„¤ì •
- [x] M1-E4-T05: package.json í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ ë° Lefthook í†µí•©
- [x] M1-E4-T06: ê¸°ëŠ¥ ì¶”ê°€/ìˆ˜ì • í›„ TypeScript íƒ€ì… ê²€ì‚¬(`pnpm tsc`) ìˆ˜í–‰ ê·œì¹™ ë¬¸ì„œí™”

---

# Milestone 2 â€” Photo Mode Core Flow

## Epic 2.1 â€” FSM êµ¬ì¶•
- [x] M2-E1-T01: Step Enum ì •ì˜
- [x] M2-E1-T02: Transition Table ì •ì˜
- [x] M2-E1-T03: Zustand FSM Store êµ¬ì¶•

## Epic 2.2 â€” SELECT_MODE Step
- [x] M2-E2-T01: Photo/Map ì„ íƒ UI + UI í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬(ModeCard/SelectModeView)
- [x] M2-E2-T02: Step ì´ë™ ì²˜ë¦¬ + Page í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬(SelectModePage)
- [x] M2-E2-T03: í˜ì´ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ + Step ê³µí†µ ë ˆì´ì•„ì›ƒ(ë„ˆë¹„/í—¤ë”) + StepHeader ìŠ¤í† ë¦¬ ì¶”ê°€

## Epic 2.3 â€” UPLOAD Step
- [x] M2-E3-T01: ì´ë¯¸ì§€ ì—…ë¡œë“œ(Dropzone) + íŒŒì¼ ìƒíƒœ ì €ì¥(entities/photo) + MATCH ì´ë™ + UI/Page í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬

## Epic 2.4 â€” MATCH Step
- [x] M2-E4-T01: Person ë§ˆì»¤ ì‹œìŠ¤í…œ êµ¬í˜„ (ìµœëŒ€ 5ëª…, ìƒ‰ìƒ ë°°ì •, ë“œë˜ê·¸ ì´ë™, ì¸ë¬¼ ì¶”ê°€ ì‹œ ê¸°ë³¸ ìŠ¤íƒ ë°°ì¹˜)
- [x] M2-E4-T02: ë§ˆì»¤ ìŠ¤ì¼€ì¼/íšŒì „ í•¸ë“¤ êµ¬í˜„ (Active ìƒíƒœì—ì„œë§Œ í‘œì‹œ)
- [x] M2-E4-T03: ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ë° ì´ë¯¸ì§€ ì˜¤í”„ì…‹/í¬ê¸° ì¡°ì • ê¸°ëŠ¥
- [x] M2-E4-T04: ì¸ë¬¼ ì„¤ì • íŒ¨ë„ UI (ì¶”ê°€/ì‚­ì œ/ì´ˆê¸°í™” ë²„íŠ¼)
- [x] M2-E4-T05: ë’¤ë¡œê°€ê¸° ì‹œ Person ìƒíƒœ ì´ˆê¸°í™”
- [x] M2-E4-T06: AI ì´ë¯¸ì§€ ìƒì„±ìš© ë°ì´í„° ë‚´ë³´ë‚´ê¸° ìœ í‹¸ë¦¬í‹° (PersonForAI, MatchStepDataForAI)
- [x] M2-E4-T07: MATCH Step ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸/ìŠ¤í† ë¦¬ ì‘ì„± (AGENTS.md ê·œì¹™ ì¤€ìˆ˜)

## Epic 2.5 â€” EXPRESSION Step (ì‹ ê·œ)
- [x] M2-E5-T01: EXPRESSION Step ì¶”ê°€ (FSM ì „ì´ ê·œì¹™ ì—…ë°ì´íŠ¸)
- [x] M2-E5-T02: ExpressionSelectView í”Œë ˆì´ìŠ¤í™€ë” UI
- [x] M2-E5-T03: ì¸ë¬¼ë³„ í‘œì • ì„ íƒ UI êµ¬í˜„ (emoji-picker-react ì‚¬ìš©)
- [ ] M2-E5-T04: í‘œì • ë°ì´í„° ì €ì¥ ë° AI ì „ë‹¬ìš© í¬ë§·

## Epic 2.6 â€” ì–¼êµ´ ê²€ì¦ (MATCH Step í†µí•©)
- [x] M2-E6-T01: Azure Face API Wrapper ì‘ì„±
- [x] M2-E6-T02: MATCH Stepì—ì„œ ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ì‹œ Azure Face ê²€ì¦ í†µí•©
- [x] M2-E6-T03: ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì í”¼ë“œë°± UI (WARN/FAIL ì²˜ë¦¬)
- [x] M2-E6-T04: ê²€ì¦ í†µê³¼ ì‹œ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰ í—ˆìš©

## Epic 2.7 â€” PAYMENT Step
- [ ] M2-E7-T01: Toss Payments SDK ì—°ë™
- [ ] M2-E7-T02: ê²°ì œ ì„±ê³µ ì²˜ë¦¬
- [ ] M2-E7-T03: ê²°ì œ ì‹¤íŒ¨ ì²˜ë¦¬

## Epic 2.8 â€” GENERATE Step
- [ ] M2-E8-T01: Nanobanana Payload Builder
- [ ] M2-E8-T02: 3ì¥ ìƒì„± ìš”ì²­
- [ ] M2-E8-T03: ì‹¤íŒ¨ ì‹œ 1ì¥ ì¬ìƒì„± ê¸°ëŠ¥

## Epic 2.9 â€” RESULT Step
- [ ] M2-E9-T01: 3ì¥ ì¸ë„¤ì¼ ë Œë”ë§
- [ ] M2-E9-T02: ì´ë¯¸ì§€ í™•ëŒ€ ë³´ê¸°
- [ ] M2-E9-T03: ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
- [ ] M2-E9-T04: ë‹¨ì¼ ì¬ìƒì„± ë²„íŠ¼ ì²˜ë¦¬

---

# Milestone 3 â€” Map Mode Core Flow

## Epic 3.1 â€” ì§€ë„ UI
- [ ] M3-E1-T01: Google Maps JS SDK ë¡œë”©
- [ ] M3-E1-T02: ì¥ì†Œ ê²€ìƒ‰ UI(SearchBox)
- [ ] M3-E1-T03: ì¢Œí‘œ ê¸°ë°˜ Reverse Geocoding
- [ ] M3-E1-T04: ì¥ì†Œ ì„ íƒ UI

## Epic 3.2 â€” í”„ë¡¬í”„íŠ¸ ìƒì„±
- [ ] M3-E2-T01: ì¥ì†Œ ì •ë³´ íŒŒì„œ
- [ ] M3-E2-T02: Nanobanana Prompt Builder

## Epic 3.3 â€” Flow í†µí•©
- [ ] M3-E3-T01: Map Mode Step Flow êµ¬ì„±
- [ ] M3-E3-T02: MATCH â†’ ê²€ì¦ â†’ ê²°ì œ â†’ ìƒì„± ì—°ê²°

---

# Milestone 4 â€” AI Generation

## Epic 4.1 â€” Nanobanana Integration
- [ ] M4-E1-T01: ì´ë¯¸ì§€ ìƒì„± ì„œë²„ì•¡ì…˜
- [ ] M4-E1-T02: Mock ì‘ë‹µ ëª¨ë¸ êµ¬ì„±
- [ ] M4-E1-T03: Payload ê²€ì¦
- [ ] M4-E1-T04: ì¬ìƒì„± ê¸°ëŠ¥ ë¶„ë¦¬

## Epic 4.2 â€” ì´ë¯¸ì§€ ì·¨ê¸‰
- [ ] M4-E2-T01: ì—…ë¡œë“œ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ ì²˜ë¦¬
- [ ] M4-E2-T02: ìƒì„± í›„ ë©”ëª¨ë¦¬ ì‚­ì œ

---

# Milestone 5 â€” Testing System

## Epic 5.1 â€” Unit Test
- [ ] M5-E1-T01: FSM Unit Test
- [x] M5-E1-T02: ì–¼êµ´ ê²€ì¦ ë¡œì§ Test
- [ ] M5-E1-T03: Payload builder Test
- [ ] M5-E1-T04: Orientation fix Test
- [ ] M5-E1-T05: ì¥ì†Œ í”„ë¡¬í”„íŠ¸ Test

## Epic 5.2 â€” Integration Test (MSW)
- [ ] M5-E2-T01: ì—…ë¡œë“œâ†’ê²€ì¦ PASS Test
- [ ] M5-E2-T02: ê²€ì¦ FAIL ë¡¤ë°± Test
- [ ] M5-E2-T03: ê²°ì œ íë¦„ Test
- [ ] M5-E2-T04: ìƒì„± 3ì¥ ì²˜ë¦¬ Test
- [ ] M5-E2-T05: ì¬ìƒì„± Test

## Epic 5.3 â€” E2E (Playwright)
- [ ] M5-E3-T01: Photo Mode Happy Path
- [ ] M5-E3-T02: Map Mode Happy Path

---

# Milestone 6 â€” QA / Sentry / Deployment

## Epic 6.1 â€” QA & UX
- [ ] M6-E1-T01: ì—ëŸ¬ ì²˜ë¦¬ Toast
- [ ] M6-E1-T02: Step ì‹¤íŒ¨ UX ì ê²€
- [ ] M6-E1-T03: ìƒì„± ì‹¤íŒ¨ ì¬ì‹œë„ UX
- [ ] M6-E1-T04: ë¸Œëœë“œ í†¤ ê²€ìˆ˜

## Epic 6.2 â€” Monitoring
- [ ] M6-E2-T01: Sentry FE ì„¤ì¹˜
- [ ] M6-E2-T02: Sentry Server Actions ì„¤ì¹˜

## Epic 6.3 â€” Deployment
- [ ] M6-E3-T01: Vercel í™˜ê²½ë³€ìˆ˜ ì„¤ì •
- [ ] M6-E3-T02: Custom Domain ì—°ê²°
- [ ] M6-E3-T03: Production ë°°í¬
